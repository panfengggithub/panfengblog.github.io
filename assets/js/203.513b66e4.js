(window.webpackJsonp=window.webpackJsonp||[]).push([[203],{616:function(t,s,a){"use strict";a.r(s);var n=a(1),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"执行引擎、jit、逃逸分析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#执行引擎、jit、逃逸分析"}},[t._v("#")]),t._v(" "),s("strong",[t._v("执行引擎、JIT、逃逸分析")])]),t._v(" "),s("p",[t._v("今天开始讲JVM四大模块中的执行引擎。这个东西也是JVM的精髓之一，非常底层。")]),t._v(" "),s("h2",{attrs:{id:"java是半编译半解释型语言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java是半编译半解释型语言"}},[t._v("#")]),t._v(" Java是半编译半解释型语言")]),t._v(" "),s("p",[t._v("如果面试官问你这个问题，要分成两个角度来讲解")]),t._v(" "),s("p",[t._v("1、javac编译，java运行")]),t._v(" "),s("p",[t._v("2、运行期即时编译+解释执行")]),t._v(" "),s("h2",{attrs:{id:"两种解释器的底层实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#两种解释器的底层实现"}},[t._v("#")]),t._v(" 两种解释器的底层实现")]),t._v(" "),s("p",[t._v("JVM中目前来说有两种解释器")]),t._v(" "),s("p",[s("strong",[t._v("具体细节见课堂上操作实战")])]),t._v(" "),s("h4",{attrs:{id:"_1、字节码解释器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、字节码解释器"}},[t._v("#")]),t._v(" 1、字节码解释器")]),t._v(" "),s("p",[t._v("做的事情是：java字节码->c++代码->硬编码")]),t._v(" "),s("div",{staticClass:"language-cpp line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-cpp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CASE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_new"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        u2 index "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Bytes")]),s("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_Java_u2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pc"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        ConstantPool"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" constants "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" istate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("method")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("constants")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("constants"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tag_at")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("is_unresolved_klass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Make sure klass is initialized and doesn't have a finalizer")]),t._v("\n          Klass"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" entry "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" constants"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("slot_at")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_klass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("assert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("entry"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("is_klass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Should be resolved klass"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          Klass"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" k_entry "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Klass"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" entry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("assert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k_entry"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("oop_is_instance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Should be InstanceKlass"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          InstanceKlass"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" ik "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("InstanceKlass"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" k_entry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" ik"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("is_initialized")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" ik"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("can_be_fastpath_allocated")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n ……\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])]),s("h4",{attrs:{id:"_2、模板解释器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、模板解释器"}},[t._v("#")]),t._v(" 2、模板解释器")]),t._v(" "),s("p",[t._v("做的事情：java字节码->硬编码")]),t._v(" "),s("p",[t._v("有对硬编码的生成规则感兴趣的同学吗？")]),t._v(" "),s("div",{staticClass:"language-cpp line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-cpp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TemplateTable")]),s("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("_new")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("transition")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vtos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" atos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  Label slow_case"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  Label done"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  Label initialize_header"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  Label initialize_object"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// including clearing the fields")]),t._v("\n\n  Register RallocatedObject "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Otos_i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  Register RinstanceKlass "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" O1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  Register Roffset "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" O3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  Register Rscratch "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" O4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  __ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_2_byte_integer_at_bcp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Rscratch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Roffset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" InterpreterMacroAssembler"),s("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("Unsigned"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  __ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_cpool_and_tags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Rscratch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" G3_scratch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// make sure the class we're about to instantiate has been resolved")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// This is done before loading InstanceKlass to be consistent with the order")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// how Constant Pool is updated (see ConstantPool::klass_at_put)")]),t._v("\n  __ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("G3_scratch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Array")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("u1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("base_offset_in_bytes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" G3_scratch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  __ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ldub")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("G3_scratch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Roffset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" G3_scratch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  __ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cmp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("G3_scratch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" JVM_CONSTANT_Class"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  __ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("br")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Assembler"),s("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("notEqual"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Assembler"),s("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("pn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" slow_case"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n……    \n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2020/png/2179815/1597112419659-571b768a-17d0-4b64-81ab-f8a04c2804fa.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_34%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10",alt:"img"}})]),t._v(" "),s("h2",{attrs:{id:"三种运行模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三种运行模式"}},[t._v("#")]),t._v(" 三种运行模式")]),t._v(" "),s("p",[t._v("JIT为什么能提升性能呢？原因是运行期的热点代码编译与缓存")]),t._v(" "),s("p",[t._v("JVM中有两种即时编译器，就诞生了三种运行模式")]),t._v(" "),s("p",[t._v("-Xint：纯字节码解释器模式")]),t._v(" "),s("p",[t._v("-Xcomp：纯模板解释器模式")]),t._v(" "),s("p",[t._v("-Xmixed：字节码解释器+模板解释器模式（默认）")]),t._v(" "),s("p",[t._v("这三种模式，哪种效率最高呢？课堂上代码演示。")]),t._v(" "),s("h2",{attrs:{id:"两种即时编译器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#两种即时编译器"}},[t._v("#")]),t._v(" 两种即时编译器")]),t._v(" "),s("p",[t._v("jdk6以前是没有混合编译的，后来根据两种编译器的使用场景组合起来使用进一步提升性能")]),t._v(" "),s("p",[t._v("1、C1编译器")]),t._v(" "),s("p",[t._v("-client模式启动，默认启动的是C1编译器。有哪些特点呢？")]),t._v(" "),s("p",[t._v("1、需要收集的数据较少，即达到触发即时编译的条件较宽松")]),t._v(" "),s("p",[t._v("2、自带的编译优化优化的点较少")]),t._v(" "),s("p",[t._v("3、编译时较C2，没那么耗CPU，带来的结果是编译后生成的代码执行效率较C2低")]),t._v(" "),s("p",[t._v("2、C2编译器")]),t._v(" "),s("p",[t._v("-server模式启动。有哪些特点呢？")]),t._v(" "),s("p",[t._v("1、需要收集的数据较多")]),t._v(" "),s("p",[t._v("2、编译时很耗CPU")]),t._v(" "),s("p",[t._v("3、编译优化的点较多")]),t._v(" "),s("p",[t._v("4、编译生成的代码执行效率高")]),t._v(" "),s("p",[t._v("3、混合编译")]),t._v(" "),s("p",[t._v("目前的-server模式启动，已经不是纯粹只使用C2。程序运行初期因为产生的数据较少，这时候执行C1编译，程序执行一段时间后，收集到足够的数据，执行C2编译器")]),t._v(" "),s("p",[t._v("Mac中是无法使用JIT的！因为Mac无法申请一块可读可写可执行的内存块")]),t._v(" "),s("h2",{attrs:{id:"即时编译触发条件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#即时编译触发条件"}},[t._v("#")]),t._v(" 即时编译触发条件")]),t._v(" "),s("p",[t._v("目前的64bit机器上只有server模式。大家现在谈执行引擎，说的都是server模式启动的JVM中的执行引擎")]),t._v(" "),s("p",[t._v("触发即时编译的最小单位是代码段，最大单位是方法")]),t._v(" "),s("p",[t._v("Client 编译器模式下，N 默认的值 1500")]),t._v(" "),s("p",[t._v("Server 编译器模式下，N 默认的值则是 10000")]),t._v(" "),s("h2",{attrs:{id:"热点代码缓存区"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#热点代码缓存区"}},[t._v("#")]),t._v(" 热点代码缓存区")]),t._v(" "),s("p",[t._v("热点代码缓存是保存在方法区的，这块也是调优需要调的地方")]),t._v(" "),s("p",[t._v("server 编译器模式下代码缓存大小则起始于 2496KB")]),t._v(" "),s("p",[t._v("client 编译器模式下代码缓存大小起始于 160KB")]),t._v(" "),s("p",[t._v("java -XX:+PrintFlagsFinal -version | grep InitialCodeCacheSize")]),t._v(" "),s("h2",{attrs:{id:"逃逸分析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#逃逸分析"}},[t._v("#")]),t._v(" 逃逸分析")]),t._v(" "),s("p",[s("strong",[t._v("具体细节见课堂上操作实战")])]),t._v(" "),s("p",[t._v("逃逸分析这个词可要拆成两个词来理解：逃逸、分析")]),t._v(" "),s("p",[t._v("同学们可要先想想：为什么要做逃逸分析？")]),t._v(" "),s("p",[t._v("基于逃逸分析诞生的三种优化策略：")]),t._v(" "),s("h4",{attrs:{id:"_1、栈上分配"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、栈上分配"}},[t._v("#")]),t._v(" 1、栈上分配")]),t._v(" "),s("p",[t._v("如何证明栈上分配的存在？")]),t._v(" "),s("h4",{attrs:{id:"_2、标量替换"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、标量替换"}},[t._v("#")]),t._v(" 2、标量替换")]),t._v(" "),s("h4",{attrs:{id:"_3、锁消除"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3、锁消除"}},[t._v("#")]),t._v(" 3、锁消除")]),t._v(" "),s("h2",{attrs:{id:"练习"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#练习"}},[t._v("#")]),t._v(" 练习")]),t._v(" "),s("p",[t._v("1、课堂上的案例自己跑一遍，深入理解")])])}),[],!1,null,null,null);s.default=e.exports}}]);