(window.webpackJsonp=window.webpackJsonp||[]).push([[187],{600:function(e,r,t){"use strict";t.r(r);var v=t(1),_=Object(v.a)({},(function(){var e=this,r=e._self._c;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"删除策略"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#删除策略"}},[e._v("#")]),e._v(" "),r("strong",[e._v("删除策略")])]),e._v(" "),r("p",[e._v("定时删除--\x3e以CPU内存换redis内存")]),e._v(" "),r("p",[e._v("惰性删除--\x3e以redis内存换CPU内存")]),e._v(" "),r("p",[e._v("定期删除")]),e._v(" "),r("p",[e._v("redis使用：惰性删除+定期删除")]),e._v(" "),r("p",[e._v("1.redis在启动的时候读取配置文件hz的值，默认为10")]),e._v(" "),r("p",[e._v("2.每秒执行hz次serverCron()--\x3edatabasesCron()---\x3eactveEXpireCyle()")]),e._v(" "),r("p",[e._v("3.actveEXpireCyle()对每个expires[*]进行逐一检测，每次执行250ms/hz")]),e._v(" "),r("p",[e._v("4.对某个expires[*]检测时，随机挑选N个key检查")]),e._v(" "),r("p",[e._v("​\t如果key超时，删除key")]),e._v(" "),r("p",[e._v("​\t如果一轮中删除的key的数量>N*25%，循环该过程")]),e._v(" "),r("p",[e._v("​\t如果一轮中删除的key的数量小于等于N"),r("em",[e._v("25%,检查下一个expires[")]),e._v("  ]")]),e._v(" "),r("p",[e._v("current_db用于记录actveEXpireCyle()进入哪个expires[ * ] 执行，如果时间到了，那么下次根据current_db继续执行")])])}),[],!1,null,null,null);r.default=_.exports}}]);