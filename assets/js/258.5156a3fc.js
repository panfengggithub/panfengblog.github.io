(window.webpackJsonp=window.webpackJsonp||[]).push([[258],{673:function(a,s,n){"use strict";n.r(s);var e=n(1),t=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"nginx-热备部署-双主模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nginx-热备部署-双主模式"}},[a._v("#")]),a._v(" nginx 热备部署  双主模式")]),a._v(" "),s("p",[s("strong",[a._v("用nginx做负载均衡，作为架构的最前端或中间层，随着日益增长的访问量，需要给负载均衡做高可用架构，利用keepalived解决单点风险，一旦 nginx宕机能快速切换到备份服务器")])]),a._v(" "),s("p",[a._v("安装 keepalived")]),a._v(" "),s("p",[s("img",{attrs:{src:"C:%5CUsers%5CQiYuan%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1606392057823.png",alt:"1606392057823"}})]),a._v(" "),s("p",[a._v("安装   keepalived")]),a._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[a._v("yum install nginx keepalived pcre-devel  -y\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("strong",[a._v("配置keepalived高可用，修改主配置文件")])]),a._v(" "),s("p",[a._v("两台均备份")]),a._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[a._v("cp /etc/keepalived/keepalived.conf keepalived.conf.bak\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"C:%5CUsers%5CQiYuan%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1606392217107.png",alt:"1606392217107"}})]),a._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[a._v(" global_defs {\n    vrrp_garp_interval 0\n    vrrp_gna_interval 0\n }\n vrrp_instance VI_1 {\n     state MASTER    #备用机 修改为 BACKUP\n     interface enp0s8\n     virtual_router_id 50\n     priority 100   # 参数 备用比主机低就可以了 \n     advert_int 1\n     authentication {\n         auth_type PASS\n         auth_pass 1111\n     }\n     virtual_ipaddress {\n         192.168.56.120\n     }\n }\n~        \n\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br")])]),s("p",[a._v("启动 两台的nginx")]),a._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[a._v("systemctl start nginx\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("启动 keepalived")]),a._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[a._v("service keepalived start\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("检查下状态")]),a._v(" "),s("p",[s("img",{attrs:{src:"C:%5CUsers%5CQiYuan%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1606392438737.png",alt:"1606392438737"}})]),a._v(" "),s("p",[a._v("检查下IP")]),a._v(" "),s("p",[s("img",{attrs:{src:"C:%5CUsers%5CQiYuan%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1606392527754.png",alt:"1606392527754"}})]),a._v(" "),s("p",[a._v("检查页面访问")]),a._v(" "),s("p",[s("img",{attrs:{src:"C:%5CUsers%5CQiYuan%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1606392544374.png",alt:"1606392544374"}})])])}),[],!1,null,null,null);s.default=t.exports}}]);