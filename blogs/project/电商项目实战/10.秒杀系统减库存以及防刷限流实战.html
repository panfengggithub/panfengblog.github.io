<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>秒杀系统减库存以及防刷限流实战 | 编程印象</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="我盼世界无 bug">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.6ae13786.css" as="style"><link rel="preload" href="/assets/js/app.8442cce6.js" as="script"><link rel="preload" href="/assets/js/3.fb47a76d.js" as="script"><link rel="preload" href="/assets/js/1.fc79f8d4.js" as="script"><link rel="preload" href="/assets/js/261.4033dba7.js" as="script"><link rel="prefetch" href="/assets/js/10.116d34d6.js"><link rel="prefetch" href="/assets/js/100.823a6c1d.js"><link rel="prefetch" href="/assets/js/101.33bf8b76.js"><link rel="prefetch" href="/assets/js/102.3baa42c8.js"><link rel="prefetch" href="/assets/js/103.b7c79b9f.js"><link rel="prefetch" href="/assets/js/104.587a5c14.js"><link rel="prefetch" href="/assets/js/105.8d2526d8.js"><link rel="prefetch" href="/assets/js/106.354bcc81.js"><link rel="prefetch" href="/assets/js/107.425755c2.js"><link rel="prefetch" href="/assets/js/108.aa00c74d.js"><link rel="prefetch" href="/assets/js/109.2e8fd96f.js"><link rel="prefetch" href="/assets/js/11.0dcebd6a.js"><link rel="prefetch" href="/assets/js/110.6498c945.js"><link rel="prefetch" href="/assets/js/111.452d3d09.js"><link rel="prefetch" href="/assets/js/112.be118191.js"><link rel="prefetch" href="/assets/js/113.94f9f4d8.js"><link rel="prefetch" href="/assets/js/114.3b2480a0.js"><link rel="prefetch" href="/assets/js/115.5595e42d.js"><link rel="prefetch" href="/assets/js/116.0ed666dd.js"><link rel="prefetch" href="/assets/js/117.7ed383ef.js"><link rel="prefetch" href="/assets/js/118.7e05acd6.js"><link rel="prefetch" href="/assets/js/119.af237b99.js"><link rel="prefetch" href="/assets/js/12.9cd4073d.js"><link rel="prefetch" href="/assets/js/120.165638db.js"><link rel="prefetch" href="/assets/js/121.8740754f.js"><link rel="prefetch" href="/assets/js/122.a5e7822e.js"><link rel="prefetch" href="/assets/js/123.8b77ff31.js"><link rel="prefetch" href="/assets/js/124.d932abc0.js"><link rel="prefetch" href="/assets/js/125.25c5ea9b.js"><link rel="prefetch" href="/assets/js/126.c1cde31a.js"><link rel="prefetch" href="/assets/js/127.7754ab01.js"><link rel="prefetch" href="/assets/js/128.3fa13fbb.js"><link rel="prefetch" href="/assets/js/129.8b8b7075.js"><link rel="prefetch" href="/assets/js/13.fcb48276.js"><link rel="prefetch" href="/assets/js/130.4d331d0c.js"><link rel="prefetch" href="/assets/js/131.6f0bc841.js"><link rel="prefetch" href="/assets/js/132.673d383f.js"><link rel="prefetch" href="/assets/js/133.5dd56baf.js"><link rel="prefetch" href="/assets/js/134.533970d1.js"><link rel="prefetch" href="/assets/js/135.c25b654d.js"><link rel="prefetch" href="/assets/js/136.22dbb32c.js"><link rel="prefetch" href="/assets/js/137.b4a4f949.js"><link rel="prefetch" href="/assets/js/138.f14e0ad2.js"><link rel="prefetch" href="/assets/js/139.31fd5cfe.js"><link rel="prefetch" href="/assets/js/14.1f0e0ce2.js"><link rel="prefetch" href="/assets/js/140.4a0dc494.js"><link rel="prefetch" href="/assets/js/141.8a8ee934.js"><link rel="prefetch" href="/assets/js/142.cee356f2.js"><link rel="prefetch" href="/assets/js/143.854af5fe.js"><link rel="prefetch" href="/assets/js/144.5b3e73b9.js"><link rel="prefetch" href="/assets/js/145.44339ca0.js"><link rel="prefetch" href="/assets/js/146.337a1810.js"><link rel="prefetch" href="/assets/js/147.0c4d7906.js"><link rel="prefetch" href="/assets/js/148.ed1fc683.js"><link rel="prefetch" href="/assets/js/149.7ab72452.js"><link rel="prefetch" href="/assets/js/15.3c6456a2.js"><link rel="prefetch" href="/assets/js/150.91f47cb4.js"><link rel="prefetch" href="/assets/js/151.faa29a85.js"><link rel="prefetch" href="/assets/js/152.459f04e8.js"><link rel="prefetch" href="/assets/js/153.862d9e1b.js"><link rel="prefetch" href="/assets/js/154.9015b797.js"><link rel="prefetch" href="/assets/js/155.823d067e.js"><link rel="prefetch" href="/assets/js/156.4a823b20.js"><link rel="prefetch" href="/assets/js/157.074b7eb0.js"><link rel="prefetch" href="/assets/js/158.58626e34.js"><link rel="prefetch" href="/assets/js/159.4210bf30.js"><link rel="prefetch" href="/assets/js/16.7c03f291.js"><link rel="prefetch" href="/assets/js/160.76aacf66.js"><link rel="prefetch" href="/assets/js/161.3a262a40.js"><link rel="prefetch" href="/assets/js/162.5135a684.js"><link rel="prefetch" href="/assets/js/163.d07985ce.js"><link rel="prefetch" href="/assets/js/164.94a0f7fc.js"><link rel="prefetch" href="/assets/js/165.3ef4897f.js"><link rel="prefetch" href="/assets/js/166.24530c20.js"><link rel="prefetch" href="/assets/js/167.5de5928a.js"><link rel="prefetch" href="/assets/js/168.5ffc0fcb.js"><link rel="prefetch" href="/assets/js/169.7fb5c6c0.js"><link rel="prefetch" href="/assets/js/17.165a37ea.js"><link rel="prefetch" href="/assets/js/170.eee96363.js"><link rel="prefetch" href="/assets/js/171.8d4887ea.js"><link rel="prefetch" href="/assets/js/172.6c47fa35.js"><link rel="prefetch" href="/assets/js/173.431dbccc.js"><link rel="prefetch" href="/assets/js/174.c27f66e7.js"><link rel="prefetch" href="/assets/js/175.9602e333.js"><link rel="prefetch" href="/assets/js/176.b471c494.js"><link rel="prefetch" href="/assets/js/177.b4343020.js"><link rel="prefetch" href="/assets/js/178.fa742ba6.js"><link rel="prefetch" href="/assets/js/179.0ecbf2c2.js"><link rel="prefetch" href="/assets/js/18.d9c42027.js"><link rel="prefetch" href="/assets/js/180.f4cfdb19.js"><link rel="prefetch" href="/assets/js/181.c334acdb.js"><link rel="prefetch" href="/assets/js/182.f0c7a111.js"><link rel="prefetch" href="/assets/js/183.6f2f954d.js"><link rel="prefetch" href="/assets/js/184.d98eb7cc.js"><link rel="prefetch" href="/assets/js/185.bc4e6882.js"><link rel="prefetch" href="/assets/js/186.b34ed5db.js"><link rel="prefetch" href="/assets/js/187.e4b0648b.js"><link rel="prefetch" href="/assets/js/188.692d8b15.js"><link rel="prefetch" href="/assets/js/189.6d80bc0e.js"><link rel="prefetch" href="/assets/js/19.0f898f51.js"><link rel="prefetch" href="/assets/js/190.6ff1af1b.js"><link rel="prefetch" href="/assets/js/191.d0ed1ae7.js"><link rel="prefetch" href="/assets/js/192.344e6030.js"><link rel="prefetch" href="/assets/js/193.ae745c51.js"><link rel="prefetch" href="/assets/js/194.a36aafc7.js"><link rel="prefetch" href="/assets/js/195.3a4b0a37.js"><link rel="prefetch" href="/assets/js/196.eb7b3195.js"><link rel="prefetch" href="/assets/js/197.5e883d99.js"><link rel="prefetch" href="/assets/js/198.d41c46e1.js"><link rel="prefetch" href="/assets/js/199.c9c78cf7.js"><link rel="prefetch" href="/assets/js/20.6219f4f8.js"><link rel="prefetch" href="/assets/js/200.39f85e85.js"><link rel="prefetch" href="/assets/js/201.d8e8a00e.js"><link rel="prefetch" href="/assets/js/202.3ba8e956.js"><link rel="prefetch" href="/assets/js/203.f09e1316.js"><link rel="prefetch" href="/assets/js/204.7425d835.js"><link rel="prefetch" href="/assets/js/205.2f318618.js"><link rel="prefetch" href="/assets/js/206.2d83ef66.js"><link rel="prefetch" href="/assets/js/207.6aa7b608.js"><link rel="prefetch" href="/assets/js/208.0f22b0bb.js"><link rel="prefetch" href="/assets/js/209.309a0f21.js"><link rel="prefetch" href="/assets/js/21.d5927496.js"><link rel="prefetch" href="/assets/js/210.c0e4c8cb.js"><link rel="prefetch" href="/assets/js/211.b6ab9e15.js"><link rel="prefetch" href="/assets/js/212.4761da1e.js"><link rel="prefetch" href="/assets/js/213.5efdd22c.js"><link rel="prefetch" href="/assets/js/214.5ad0fe6d.js"><link rel="prefetch" href="/assets/js/215.d94f69cc.js"><link rel="prefetch" href="/assets/js/216.964ee825.js"><link rel="prefetch" href="/assets/js/217.29739f79.js"><link rel="prefetch" href="/assets/js/218.524e9a47.js"><link rel="prefetch" href="/assets/js/219.5917ccaa.js"><link rel="prefetch" href="/assets/js/22.07945e19.js"><link rel="prefetch" href="/assets/js/220.18f31d3d.js"><link rel="prefetch" href="/assets/js/221.1fb81b3c.js"><link rel="prefetch" href="/assets/js/222.c3990419.js"><link rel="prefetch" href="/assets/js/223.83ba9eaa.js"><link rel="prefetch" href="/assets/js/224.776b0e76.js"><link rel="prefetch" href="/assets/js/225.9a1641f3.js"><link rel="prefetch" href="/assets/js/226.d669fdc1.js"><link rel="prefetch" href="/assets/js/227.3d60a7cb.js"><link rel="prefetch" href="/assets/js/228.0aed8a8b.js"><link rel="prefetch" href="/assets/js/229.fc0ea5ca.js"><link rel="prefetch" href="/assets/js/23.8dd50c6b.js"><link rel="prefetch" href="/assets/js/230.bb1121ef.js"><link rel="prefetch" href="/assets/js/231.62a26295.js"><link rel="prefetch" href="/assets/js/232.2084cc1f.js"><link rel="prefetch" href="/assets/js/233.63b51a04.js"><link rel="prefetch" href="/assets/js/234.6d48aa1a.js"><link rel="prefetch" href="/assets/js/235.dbdb23fb.js"><link rel="prefetch" href="/assets/js/236.921fef0b.js"><link rel="prefetch" href="/assets/js/237.fca322a2.js"><link rel="prefetch" href="/assets/js/238.aa0d1935.js"><link rel="prefetch" href="/assets/js/239.a43c704d.js"><link rel="prefetch" href="/assets/js/24.be20ba76.js"><link rel="prefetch" href="/assets/js/240.2b7ba4f9.js"><link rel="prefetch" href="/assets/js/241.ac1ae6ce.js"><link rel="prefetch" href="/assets/js/242.aecfb40a.js"><link rel="prefetch" href="/assets/js/243.48ab05f1.js"><link rel="prefetch" href="/assets/js/244.c23a206b.js"><link rel="prefetch" href="/assets/js/245.b47565d7.js"><link rel="prefetch" href="/assets/js/246.00d37ab4.js"><link rel="prefetch" href="/assets/js/247.b8b26d07.js"><link rel="prefetch" href="/assets/js/248.bdd3d866.js"><link rel="prefetch" href="/assets/js/249.edce6a8a.js"><link rel="prefetch" href="/assets/js/25.c8b6404b.js"><link rel="prefetch" href="/assets/js/250.acfc827e.js"><link rel="prefetch" href="/assets/js/251.5966c2df.js"><link rel="prefetch" href="/assets/js/252.77b0b468.js"><link rel="prefetch" href="/assets/js/253.c622b0ac.js"><link rel="prefetch" href="/assets/js/254.7d309643.js"><link rel="prefetch" href="/assets/js/255.d05d685b.js"><link rel="prefetch" href="/assets/js/256.3d5fb768.js"><link rel="prefetch" href="/assets/js/257.48710f02.js"><link rel="prefetch" href="/assets/js/258.327ac731.js"><link rel="prefetch" href="/assets/js/259.808d3235.js"><link rel="prefetch" href="/assets/js/26.d5315979.js"><link rel="prefetch" href="/assets/js/260.2d6ec4b4.js"><link rel="prefetch" href="/assets/js/262.5bc1ed2f.js"><link rel="prefetch" href="/assets/js/263.84036425.js"><link rel="prefetch" href="/assets/js/264.7bacf374.js"><link rel="prefetch" href="/assets/js/265.72405e40.js"><link rel="prefetch" href="/assets/js/266.b9f44d6a.js"><link rel="prefetch" href="/assets/js/267.87f2c3b6.js"><link rel="prefetch" href="/assets/js/268.49645ab5.js"><link rel="prefetch" href="/assets/js/269.ca6e8748.js"><link rel="prefetch" href="/assets/js/27.0eec3f5f.js"><link rel="prefetch" href="/assets/js/270.b7fe2e72.js"><link rel="prefetch" href="/assets/js/271.15cf4331.js"><link rel="prefetch" href="/assets/js/272.80a56fd1.js"><link rel="prefetch" href="/assets/js/273.b64cc365.js"><link rel="prefetch" href="/assets/js/28.289cce57.js"><link rel="prefetch" href="/assets/js/29.fde4a4e4.js"><link rel="prefetch" href="/assets/js/30.491d1e80.js"><link rel="prefetch" href="/assets/js/31.592f70a1.js"><link rel="prefetch" href="/assets/js/32.e4555f39.js"><link rel="prefetch" href="/assets/js/33.7e8e2bae.js"><link rel="prefetch" href="/assets/js/34.2be510ee.js"><link rel="prefetch" href="/assets/js/35.194cc443.js"><link rel="prefetch" href="/assets/js/36.467f5687.js"><link rel="prefetch" href="/assets/js/37.1c052c5e.js"><link rel="prefetch" href="/assets/js/38.34a649c2.js"><link rel="prefetch" href="/assets/js/39.e82ef2d8.js"><link rel="prefetch" href="/assets/js/4.35359649.js"><link rel="prefetch" href="/assets/js/40.3961eea4.js"><link rel="prefetch" href="/assets/js/41.9ddbd011.js"><link rel="prefetch" href="/assets/js/42.c186e139.js"><link rel="prefetch" href="/assets/js/43.e7fc9b14.js"><link rel="prefetch" href="/assets/js/44.22c36951.js"><link rel="prefetch" href="/assets/js/45.c35f3b9a.js"><link rel="prefetch" href="/assets/js/46.8bf6d484.js"><link rel="prefetch" href="/assets/js/47.3eb12053.js"><link rel="prefetch" href="/assets/js/48.de254fa1.js"><link rel="prefetch" href="/assets/js/49.e146b309.js"><link rel="prefetch" href="/assets/js/5.6361159c.js"><link rel="prefetch" href="/assets/js/50.e7a70ca0.js"><link rel="prefetch" href="/assets/js/51.fb6e50ea.js"><link rel="prefetch" href="/assets/js/52.7d4ecea0.js"><link rel="prefetch" href="/assets/js/53.a599f7d9.js"><link rel="prefetch" href="/assets/js/54.291f55eb.js"><link rel="prefetch" href="/assets/js/55.b38a88b0.js"><link rel="prefetch" href="/assets/js/56.59d11b83.js"><link rel="prefetch" href="/assets/js/57.cabe5833.js"><link rel="prefetch" href="/assets/js/58.5f1a5d00.js"><link rel="prefetch" href="/assets/js/59.de47ab92.js"><link rel="prefetch" href="/assets/js/6.6b20e148.js"><link rel="prefetch" href="/assets/js/60.789354f9.js"><link rel="prefetch" href="/assets/js/61.b975bc21.js"><link rel="prefetch" href="/assets/js/62.07731a25.js"><link rel="prefetch" href="/assets/js/63.92a039b8.js"><link rel="prefetch" href="/assets/js/64.926954b0.js"><link rel="prefetch" href="/assets/js/65.fc896106.js"><link rel="prefetch" href="/assets/js/66.f5299cc1.js"><link rel="prefetch" href="/assets/js/67.0e3da5a7.js"><link rel="prefetch" href="/assets/js/68.ed9b55f0.js"><link rel="prefetch" href="/assets/js/69.1096d6ce.js"><link rel="prefetch" href="/assets/js/7.e9deccd6.js"><link rel="prefetch" href="/assets/js/70.6ecf5095.js"><link rel="prefetch" href="/assets/js/71.9d169690.js"><link rel="prefetch" href="/assets/js/72.f52315ec.js"><link rel="prefetch" href="/assets/js/73.6fdce6fb.js"><link rel="prefetch" href="/assets/js/74.5e4b88e3.js"><link rel="prefetch" href="/assets/js/75.7f87fefc.js"><link rel="prefetch" href="/assets/js/76.74db6339.js"><link rel="prefetch" href="/assets/js/77.9eaf63fa.js"><link rel="prefetch" href="/assets/js/78.2ba8f44f.js"><link rel="prefetch" href="/assets/js/79.bc3e123e.js"><link rel="prefetch" href="/assets/js/8.6d109cee.js"><link rel="prefetch" href="/assets/js/80.cd7fd7e9.js"><link rel="prefetch" href="/assets/js/81.0c43c39c.js"><link rel="prefetch" href="/assets/js/82.136e461c.js"><link rel="prefetch" href="/assets/js/83.f960be3d.js"><link rel="prefetch" href="/assets/js/84.3f0bbf45.js"><link rel="prefetch" href="/assets/js/85.34a823fb.js"><link rel="prefetch" href="/assets/js/86.ed8716d7.js"><link rel="prefetch" href="/assets/js/87.476ed3c6.js"><link rel="prefetch" href="/assets/js/88.d6982810.js"><link rel="prefetch" href="/assets/js/89.fa02d59d.js"><link rel="prefetch" href="/assets/js/9.e5d0cc13.js"><link rel="prefetch" href="/assets/js/90.3a62028c.js"><link rel="prefetch" href="/assets/js/91.0e5806c7.js"><link rel="prefetch" href="/assets/js/92.fd8afa61.js"><link rel="prefetch" href="/assets/js/93.bc8914e6.js"><link rel="prefetch" href="/assets/js/94.498338b1.js"><link rel="prefetch" href="/assets/js/95.99ae6ef4.js"><link rel="prefetch" href="/assets/js/96.98ae8a2e.js"><link rel="prefetch" href="/assets/js/97.dd6aee3a.js"><link rel="prefetch" href="/assets/js/98.0436ea51.js"><link rel="prefetch" href="/assets/js/99.247d44e6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6ae13786.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-5bb33761><div data-v-5bb33761><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-5bb33761 data-v-5bb33761><h3 class="title" data-v-59e6cb88>编程印象</h3> <p class="description" data-v-59e6cb88>我盼世界无 bug</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>panfeng</span>
          
        <span data-v-59e6cb88>2017 - </span>
        2023
      </a></span></div></div> <div class="hide" data-v-5bb33761><header class="navbar" data-v-5bb33761><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="编程印象" class="logo"> <span class="site-name">编程印象</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/数据库/" class="nav-link"><i class="undefined"></i>
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/categories/Devops/" class="nav-link"><i class="undefined"></i>
  Devops
</a></li><li class="dropdown-item"><!----> <a href="/categories/javaSE专题/" class="nav-link"><i class="undefined"></i>
  javaSE专题
</a></li><li class="dropdown-item"><!----> <a href="/categories/java后台框架/" class="nav-link"><i class="undefined"></i>
  java后台框架
</a></li><li class="dropdown-item"><!----> <a href="/categories/java底层专题/" class="nav-link"><i class="undefined"></i>
  java底层专题
</a></li><li class="dropdown-item"><!----> <a href="/categories/分布式/" class="nav-link"><i class="undefined"></i>
  分布式
</a></li><li class="dropdown-item"><!----> <a href="/categories/java/" class="nav-link"><i class="undefined"></i>
  java
</a></li><li class="dropdown-item"><!----> <a href="/categories/微服务/" class="nav-link"><i class="undefined"></i>
  微服务
</a></li><li class="dropdown-item"><!----> <a href="/categories/服务器/" class="nav-link"><i class="undefined"></i>
  服务器
</a></li><li class="dropdown-item"><!----> <a href="/categories/金三银四/" class="nav-link"><i class="undefined"></i>
  金三银四
</a></li><li class="dropdown-item"><!----> <a href="/categories/css/" class="nav-link"><i class="undefined"></i>
  css
</a></li><li class="dropdown-item"><!----> <a href="/categories/frontInterviewQuestions/" class="nav-link"><i class="undefined"></i>
  frontInterviewQuestions
</a></li><li class="dropdown-item"><!----> <a href="/categories/html/" class="nav-link"><i class="undefined"></i>
  html
</a></li><li class="dropdown-item"><!----> <a href="/categories/js/" class="nav-link"><i class="undefined"></i>
  js
</a></li><li class="dropdown-item"><!----> <a href="/categories/ts/" class="nav-link"><i class="undefined"></i>
  ts
</a></li><li class="dropdown-item"><!----> <a href="/categories/miniProgram/" class="nav-link"><i class="undefined"></i>
  miniProgram
</a></li><li class="dropdown-item"><!----> <a href="/categories/uniapp/" class="nav-link"><i class="undefined"></i>
  uniapp
</a></li><li class="dropdown-item"><!----> <a href="/categories/vue/" class="nav-link"><i class="undefined"></i>
  vue
</a></li><li class="dropdown-item"><!----> <a href="/categories/QYWX/" class="nav-link"><i class="undefined"></i>
  QYWX
</a></li><li class="dropdown-item"><!----> <a href="/categories/项目实战/" class="nav-link"><i class="undefined"></i>
  项目实战
</a></li><li class="dropdown-item"><!----> <a href="/categories/book/" class="nav-link"><i class="undefined"></i>
  book
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      工具推荐
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://codesandbox.io" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  codeSandbox
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://24kcs.github.io/vue3_study/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  vue3+TS
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://tool.oschina.net/uploads/apidocs/jquery/regexp.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  正则表达式手册
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://caniuse.com/?search=flex" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  兼容性查询(前端)
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://httpbin.org/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  API请求测试
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://ps.gaoding.com/#/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  在线PS
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.tiobe.com/tiobe-index/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  编程语言排行榜
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.remove.bg/zh" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  一键去除背景
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://snippet-generator.app/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  快速生成代码片段
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      关于
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/pf_java_development" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-mayun"></i>
  码云
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-5bb33761></div> <aside class="sidebar" data-v-5bb33761><div class="personal-info-wrapper" data-v-1fad0c41 data-v-5bb33761><img src="/avatar.png" alt="author-avatar" class="personal-img" data-v-1fad0c41> <h3 class="name" data-v-1fad0c41>
    panfeng
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>263</h3> <h6 data-v-1fad0c41>Articles</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>55</h3> <h6 data-v-1fad0c41>Tags</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/数据库/" class="nav-link"><i class="undefined"></i>
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/categories/Devops/" class="nav-link"><i class="undefined"></i>
  Devops
</a></li><li class="dropdown-item"><!----> <a href="/categories/javaSE专题/" class="nav-link"><i class="undefined"></i>
  javaSE专题
</a></li><li class="dropdown-item"><!----> <a href="/categories/java后台框架/" class="nav-link"><i class="undefined"></i>
  java后台框架
</a></li><li class="dropdown-item"><!----> <a href="/categories/java底层专题/" class="nav-link"><i class="undefined"></i>
  java底层专题
</a></li><li class="dropdown-item"><!----> <a href="/categories/分布式/" class="nav-link"><i class="undefined"></i>
  分布式
</a></li><li class="dropdown-item"><!----> <a href="/categories/java/" class="nav-link"><i class="undefined"></i>
  java
</a></li><li class="dropdown-item"><!----> <a href="/categories/微服务/" class="nav-link"><i class="undefined"></i>
  微服务
</a></li><li class="dropdown-item"><!----> <a href="/categories/服务器/" class="nav-link"><i class="undefined"></i>
  服务器
</a></li><li class="dropdown-item"><!----> <a href="/categories/金三银四/" class="nav-link"><i class="undefined"></i>
  金三银四
</a></li><li class="dropdown-item"><!----> <a href="/categories/css/" class="nav-link"><i class="undefined"></i>
  css
</a></li><li class="dropdown-item"><!----> <a href="/categories/frontInterviewQuestions/" class="nav-link"><i class="undefined"></i>
  frontInterviewQuestions
</a></li><li class="dropdown-item"><!----> <a href="/categories/html/" class="nav-link"><i class="undefined"></i>
  html
</a></li><li class="dropdown-item"><!----> <a href="/categories/js/" class="nav-link"><i class="undefined"></i>
  js
</a></li><li class="dropdown-item"><!----> <a href="/categories/ts/" class="nav-link"><i class="undefined"></i>
  ts
</a></li><li class="dropdown-item"><!----> <a href="/categories/miniProgram/" class="nav-link"><i class="undefined"></i>
  miniProgram
</a></li><li class="dropdown-item"><!----> <a href="/categories/uniapp/" class="nav-link"><i class="undefined"></i>
  uniapp
</a></li><li class="dropdown-item"><!----> <a href="/categories/vue/" class="nav-link"><i class="undefined"></i>
  vue
</a></li><li class="dropdown-item"><!----> <a href="/categories/QYWX/" class="nav-link"><i class="undefined"></i>
  QYWX
</a></li><li class="dropdown-item"><!----> <a href="/categories/项目实战/" class="nav-link"><i class="undefined"></i>
  项目实战
</a></li><li class="dropdown-item"><!----> <a href="/categories/book/" class="nav-link"><i class="undefined"></i>
  book
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      工具推荐
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://codesandbox.io" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  codeSandbox
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://24kcs.github.io/vue3_study/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  vue3+TS
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://tool.oschina.net/uploads/apidocs/jquery/regexp.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  正则表达式手册
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://caniuse.com/?search=flex" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  兼容性查询(前端)
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://httpbin.org/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  API请求测试
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://ps.gaoding.com/#/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  在线PS
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.tiobe.com/tiobe-index/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  编程语言排行榜
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.remove.bg/zh" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  一键去除背景
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://snippet-generator.app/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  快速生成代码片段
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      关于
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/pf_java_development" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-mayun"></i>
  码云
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-5bb33761><h3 class="title" data-v-59e6cb88>秒杀系统减库存以及防刷限流实战</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>panfeng</span>
          
        <span data-v-59e6cb88>2017 - </span>
        2023
      </a></span></div></div> <div data-v-5bb33761><div data-v-5bb33761><main class="page" style="padding-right:0;"><section style="display:;"><div class="page-title"><h1 class="title">秒杀系统减库存以及防刷限流实战</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>panfeng</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>8/15/2021</span></i> <!----> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>电商</span></i></div></div> <div class="theme-reco-content content__default"><h1 id="秒杀系统减库存以及防刷限流实战"><a href="#秒杀系统减库存以及防刷限流实战" class="header-anchor">#</a> <strong>秒杀系统减库存以及防刷限流实战</strong></h1> <h1 id="_1-同步下单"><a href="#_1-同步下单" class="header-anchor">#</a> 1.同步下单</h1> <p>优点： 方案简单，在连接不多的情况响应迅速</p> <p>缺点： 随着请求连接增多，DB性能急剧下降，导致大量请求阻塞，整个服务集群无法正常提供服务。</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1595225442069-2a6e76f1-0a02-4e71-a54d-cdd5c2ed9468.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_36%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h2 id="_2-rocketmq异步下单"><a href="#_2-rocketmq异步下单" class="header-anchor">#</a> 2.RocketMQ异步下单</h2> <p>RocketMQ架构图</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1595225442036-097ad1fd-fa14-48ef-a81c-e2fd6a3e977f.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_38%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <p>MQ消息队列处理订单：</p> <p>异步：可以处理更多订单</p> <p>削峰：更高吞吐能力和消息堆积能力</p> <p>=》在处理高并发请求时性能和吞吐量更高</p> <p>异步下单流程：</p> <ul><li><p>业务类构建订单DTO</p></li> <li><p>消息生产者发送消息返回创建订单中</p></li> <li><p>客户端轮训订单状态</p></li> <li><p>消费消费者 消费订单消息，生成订单，修改订单状态</p></li> <li><p>下单完成</p></li></ul> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1595225443018-ae79c8e3-7174-43d3-b8e3-34ac124ee062.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_42%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h2 id="_2-1-mq生产者"><a href="#_2-1-mq生产者" class="header-anchor">#</a> 2.1 MQ生产者</h2> <p><strong>生产者发送消息</strong></p> <p>@Slf4j</p> <p>@Component</p> <p>public class OrderMessageSender {</p> <p>.......</p> <p>/**</p> <p>* 发送订单消息</p> <p>* @return</p> <p>*/</p> <p>public boolean sendCreateOrderMsg(OrderMessage message){</p> <p>SendResult result = rocketMQTemplate.syncSend(asyncOrderTopic+&quot;:&quot;+ORDERTAG,message);</p> <p>return SendStatus.SEND_OK == result.getSendStatus();</p> <p><strong>业务发送订单处理</strong></p> <ul><li><strong>发送消息</strong></li> <li><strong>发送成功=》设置 订单状态 ： 1-》下单中   -1-》失败   大于1-&gt;订 单号</strong></li> <li><strong>发送失败 =》还原预减库存，删除本地 售罄标识，发送消息同步标****识</strong></li></ul> <p>@Slf4j</p> <p>@Service</p> <p>public class SecKillOrderServiceImpl implements SecKillOrderService {</p> <p>..............</p> <p>OrderMessage orderMessage = new OrderMessage();</p> <p>orderMessage.setOrder(order);</p> <p>orderMessage.setOrderItem(orderItem);</p> <p>orderMessage.setFlashPromotionRelationId(product.getFlashPromotionRelationId());</p> <p>orderMessage.setFlashPromotionLimit(product.getFlashPromotionLimit());</p> <p>orderMessage.setFlashPromotionEndDate(product.getFlashPromotionEndDate());</p> <p>Map&lt;String,Object&gt; result = new HashMap&lt;&gt;();</p> <p>List<OmsOrderItem> itemList = new ArrayList&lt;&gt;();</OmsOrderItem></p> <p>itemList.add(orderItem);</p> <p>result.put(&quot;order&quot;,order);</p> <p>result.put(&quot;orderItemList&quot;,itemList);</p> <p>try {</p> <p>boolean sendStatus = orderMessageSender.sendCreateOrderMsg(orderMessage);</p> <p>if(sendStatus){</p> <p>​    /*</p> <p>​     * 打上排队的标记</p> <p>​     */</p> <p>​    redisOpsUtil.set(RedisKeyPrefixConst.MIAOSHA_ASYNC_WAITING_PREFIX + memberId + &quot;:&quot; + productId</p> <p>​        ,Integer.toString(1),60, TimeUnit.SECONDS);</p> <p>​    /*</p> <p>​     * 下单方式0-&gt;同步下单,1-&gt;异步下单排队中,-1-&gt;秒杀失败</p> <p>​     */</p> <p>​    result.put(&quot;orderStatus&quot;,1);</p> <p>}else{</p> <p>​    /*</p> <p>​     * 还原预减库存</p> <p>​     */</p> <p>​    incrRedisStock(productId);</p> <p>​    /*</p> <p>​     * 清除掉本地guavacache已经售完的标记</p> <p>​     */</p> <p>​    cache.remove(RedisKeyPrefixConst.MIAOSHA_STOCK_CACHE_PREFIX + productId);</p> <p>​    //通知服务群,清除本地售罄标记缓存</p> <p>​    if(shouldPublishCleanMsg(productId)){</p> <p>​      redisOpsUtil.publish(&quot;cleanNoStockCache&quot;,productId);</p> <p>​    }</p> <p>​    result.put(&quot;orderStatus&quot;,-1);</p> <p>​    return CommonResult.failed(result,&quot;下单失败&quot;);</p> <p>}</p> <p>} catch (Exception e) {</p> <p>log.error(&quot;消息发送失败:error msg:{}&quot;,e.getMessage(),e.getCause());</p> <p>/*</p> <p>* 还原预减库存</p> <p>*/</p> <p>incrRedisStock(productId);</p> <p>/*</p> <p>* 清除掉本地guavacache已经售完的标记</p> <p>*/</p> <p>cache.remove(RedisKeyPrefixConst.MIAOSHA_STOCK_CACHE_PREFIX + productId);</p> <p>//通知服务群,清除本地售罄标记缓存</p> <p>if(shouldPublishCleanMsg(productId)) {</p> <p>​    redisOpsUtil.publish(&quot;cleanNoStockCache&quot;, productId);</p> <p>}</p> <p>result.put(&quot;orderStatus&quot;,-1);</p> <p>return CommonResult.failed(result,&quot;下单失败&quot;);</p> <h2 id="_2-1-消息消费创建订单"><a href="#_2-1-消息消费创建订单" class="header-anchor">#</a> 2.1  消息消费创建订单</h2> <p>创建消息消费者</p> <p>@Slf4j</p> <p>@Component</p> <p>@RocketMQMessageListener(topic = &quot;${rocketmq.luban.asyncOrderTopic}&quot;,consumerGroup = &quot;${rocketmq.luban.asyncOrderGroup}&quot;)</p> <p>public class AscynCreateOrderReciever implements RocketMQListener<OrderMessage> {</OrderMessage></p> <p>消费消息</p> <p>/**</p> <p>* 异步下单消费消息</p> <p>* @param orderMessage</p> <p>*/</p> <p>@Override</p> <p>public void onMessage(OrderMessage orderMessage) {</p> <p>log.info(&quot;listen the rocketmq message&quot;);</p> <p>Long memberId = orderMessage.getOrder().getMemberId();</p> <p>Long productId = orderMessage.getOrderItem().getProductId();</p> <p>//订单编号,分库分表不用该编号做订单结果标记</p> <p>String orderSn = orderMessage.getOrder().getOrderSn();</p> <p>Integer limit = orderMessage.getFlashPromotionLimit();</p> <p>Date endDate = orderMessage.getFlashPromotionEndDate();</p> <p>try {</p> <p>​    Long orderId = secKillOrderService.asyncCreateOrder(orderMessage.getOrder(),orderMessage.getOrderItem(),orderMessage.getFlashPromotionRelationId());</p> <p>​    //更改排队标记状态,代表已经下单成功,ID设置为snowflake后,用ID作为状态标记</p> <p>​    redisOpsUtil.set(RedisKeyPrefixConst.MIAOSHA_ASYNC_WAITING_PREFIX + memberId</p> <p>​        + &quot;:&quot; + productId,orderId.toString(),60L, TimeUnit.SECONDS);</p> <p>​    /*</p> <p>​     * 设置用户购买次数,(不限制购买次数了,需要可自行放开此处,</p> <p>​     * 并在secKillOrderService.checkConfirm中加入验证)</p> <p>​     */</p> <p>​    /*Integer rebuy = redisOpsUtil.get(RedisKeyPrefixConst.MEMBER_BUYED_MIAOSHA_PREFIX + memberId + &quot;:&quot; + productId,Integer.class);</p> <p>​    if(rebuy != null){</p> <p>​      redisOpsUtil.decr(RedisKeyPrefixConst.MEMBER_BUYED_MIAOSHA_PREFIX + memberId + &quot;:&quot; + productId);</p> <p>​    }else{</p> <p>​      //剩余时间</p> <p>​      Date now = new Date();</p> <p>​      Long expired = endDate.getTime()-now.getTime();</p> <p>​      //打上购买次数标记</p> <p>​      redisOpsUtil.set(RedisKeyPrefixConst.MEMBER_BUYED_MIAOSHA_PREFIX + memberId + &quot;:&quot; + productId,limit-1</p> <p>​          ,expired,TimeUnit.MILLISECONDS);</p> <p>​    }*/</p> <p>} catch (Exception e) {</p> <p>​    log.error(e.getMessage(),e.getCause());</p> <p>​    /*</p> <p>​     * 下单失败</p> <p>​     */</p> <p>​    redisOpsUtil.set(RedisKeyPrefixConst.MIAOSHA_ASYNC_WAITING_PREFIX + memberId</p> <p>​        + &quot;:&quot; + productId,Integer.toString(-1),60L, TimeUnit.SECONDS);</p> <p>​    //还原预减库存</p> <p>​    secKillOrderService.incrRedisStock(productId);</p> <p>​    //清除掉本地guava-cache已经售完的标记</p> <p>​    cache.remove(RedisKeyPrefixConst.MIAOSHA_STOCK_CACHE_PREFIX + productId);</p> <p>​    //通知服务群,清除本地售罄标记缓存</p> <p>​    if(secKillOrderService.shouldPublishCleanMsg(productId)) {</p> <p>​      redisOpsUtil.publish(&quot;cleanNoStockCache&quot;, productId);</p> <p>​    }</p> <p>关于消费消息异常：</p> <ol><li>消费者在未提交订单到db之前异常，需要回补库存。</li> <li>消费者在消费消息并且未提交订单到db之前，JVM崩溃。 服务器未收到消费者ACK，继续投递。</li> <li>消费者提交订单之后JVM崩溃，服务器未收到消费者ACK。消息会继续投递，此时需要校验消息的幂等性。</li></ol> <p>​       消息ID的全局唯一性</p> <p>​       消息在消费消息时首先判断消息ID是否已经存在DB，存在的时候直接返回成功，否则继续创建订单操作。</p> <h2 id="_2-2-订单成功发送延迟消息等待支付"><a href="#_2-2-订单成功发送延迟消息等待支付" class="header-anchor">#</a> 2.2  订单成功发送延迟消息等待支付</h2> <p>延迟消息 ： messageDelayLevel=1s 5s 10s 30s 1m 2m 3m 4m 5m 6m 7m 8m 9m 10m 20m 30m 1h 2h</p> <p>@Transactional</p> <p>public Long asyncCreateOrder(OmsOrder order,OmsOrderItem orderItem,Long flashPromotionRelationId) {</p> <p>//减库存</p> <p>Integer result = miaoShaStockDao.descStock(flashPromotionRelationId, 1);</p> <p>log.info(&quot;异步下单减库存成功&quot;);</p> <p>if (result &lt;= 0) {</p> <p>​    throw new RuntimeException(&quot;没抢到！&quot;);</p> <p>}</p> <p>log.info(&quot;异步下单减库存成功&quot;);</p> <p>//查询订单</p> <p>//插入订单记录</p> <p>orderMapper.insertSelective(order);</p> <p>//OrderItem关联</p> <p>orderItem.setOrderId(order.getId());</p> <p>orderItem.setOrderSn(order.getOrderSn());</p> <p>//插入orderItem</p> <p>orderItemMapper.insertSelective(orderItem);</p> <p>/*</p> <p>* 如果订单创建成功,需要发送定时消息,20min后如果没有支付,则取消当前订单,释放库存</p> <p>* 0</p> <p>* */</p> <p>try {</p> <p>​    boolean sendStatus = orderMessageSender.sendTimeOutOrderMessage(order.getId() + &quot;:&quot; + flashPromotionRelationId + &quot;:&quot; + orderItem.getProductId());</p> <p>​    if (!sendStatus) {</p> <p>​      throw new RuntimeException(&quot;订单超时取消消息发送失败！&quot;);</p> <p>​    }</p> <p>} catch (Exception e) {</p> <p>​    throw new RuntimeException(&quot;订单超时取消消息发送失败！&quot;);</p> <p>}</p> <p>return order.getId();</p> <h2 id="_2-3-超时取消订单"><a href="#_2-3-超时取消订单" class="header-anchor">#</a> 2.3 超时取消订单</h2> <p>/**</p> <p>* 消费监听rocketmq-订单超时消息</p> <p>*/</p> <p>@Slf4j</p> <p>@Component</p> <p>@RocketMQMessageListener(consumerGroup = &quot;${rocketmq.luban.cancelGroup}&quot;, topic = &quot;${rocketmq.luban.scheduleTopic}&quot;)</p> <p>public class RocketMqCancelOrderReciever implements RocketMQListener<String> {</String></p> <p>@Autowired</p> <p>private OmsPortalOrderService omsPortalOrderService;</p> <p>@Autowired</p> <p>private SecKillOrderService secKillOrderService;</p> <p>/**</p> <p>* 延时消息,取消超时订单</p> <p>* @param cancelId</p> <p>*/</p> <p>@Override</p> <p>public void onMessage(String cancelId) {</p> <p>​    log.info(&quot;监听超时订单：&quot;+cancelId);</p> <p>​    if(StringUtils.isEmpty(cancelId)){</p> <p>​      return;</p> <p>​    }</p> <p>​    Long orderId = Long.parseLong(cancelId.split(&quot;😊[0]);</p> <p>​    Long promotionId = Long.parseLong(cancelId.split(&quot;😊[1]);</p> <p>​    Long productId = Long.parseLong(cancelId.split(&quot;😊[2]);</p> <p>​    try {</p> <p>​      //取消的订单,释放DB库存</p> <p>​      omsPortalOrderService.cancelOrder(orderId,promotionId);</p> <p>​      //取消的订单-还原缓存库存</p> <p>​      secKillOrderService.incrRedisStock(productId);</p> <p>​      log.info(&quot;订单取消，orderId:{},productId:{}&quot;,orderId,productId);</p> <p>​    } catch (Exception e) {</p> <p>​      log.error(&quot;订单取消异常 : 还原库存失败，please check:{}&quot;,e.getMessage(),e.getCause());</p> <p>​      throw new RuntimeException();//抛异常出去,rocketmq会重新投递</p> <p>​    }</p> <p>}</p> <ol><li>MQ事务消息</li></ol> <p>RocketMQ事务消息架构：</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1595225442002-57060036-ee99-4a09-b972-b4b72ba300b7.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_38%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <p><strong>业务场景： 一般适用下单成功后删除购物车 ，计算积分</strong></p> <p>@Slf4j</p> <p>@RocketMQTransactionListener(txProducerGroup = &quot;${rocketmq.luban.transGroup}&quot;)</p> <p>public class TransactionListenerImpl implements RocketMQLocalTransactionListener {</p> <p>private ConcurrentHashMap&lt;String, Integer&gt; localTrans = new ConcurrentHashMap&lt;String, Integer&gt;();</p> <p>private static int maxTryMums = 3;</p> <p>@Override</p> <p>public RocketMQLocalTransactionState executeLocalTransaction(Message msg, Object orderDto) {</p> <p>​    log.info(&quot;------------RocketMQ执行本地订单创建-------------&quot;);</p> <p>​    String transId = (String)msg.getHeaders().get(RocketMQHeaders.PREFIX + RocketMQHeaders.TRANSACTION_ID);</p> <p>​    /**</p> <p>​     *</p> <p>​     * 写你的本地事务执行逻辑</p> <p>​     *</p> <p>​     * */</p> <p>​    //删除购物车  计算订单积分</p> <p>​    localTrans.put(transId, 0);</p> <p>​    return RocketMQLocalTransactionState.UNKNOWN;</p> <p>}</p> <p>@Override</p> <p>public RocketMQLocalTransactionState checkLocalTransaction(Message msg) {</p> <p>​    log.info(&quot;执行事务消息checkLocalTransaction()方法&quot;);</p> <p>​    RocketMQLocalTransactionState retState;</p> <p>​    String transId = (String)msg.getHeaders().get(RocketMQHeaders.PREFIX + RocketMQHeaders.TRANSACTION_ID);</p> <p>​     //查询 购物车是否删除成功</p> <p>​    //查询积分计算是否成功</p> <p>​    int retryTimes = localTrans.get(transId);//事务recheck次数</p> <p>​    int isExists = 0;//订单是否已经生成</p> <p>​    if(retryTimes &lt; maxTryMums &amp;&amp; isExists &gt; 0){</p> <p>​      retState = RocketMQLocalTransactionState.COMMIT;</p> <p>​      localTrans.remove(transId);</p> <p>​    }else if(retryTimes &lt; maxTryMums &amp;&amp; isExists == 0){</p> <p>​      localTrans.put(transId,retryTimes+1);</p> <p>​      retState = RocketMQLocalTransactionState.UNKNOWN;</p> <p>​    }else{</p> <p>​      retState = RocketMQLocalTransactionState.ROLLBACK;</p> <p>​      localTrans.remove(transId);</p> <p>​    }</p> <p>​    log.info(&quot;------ !!!回查订单是否成功提交,msgTransactionId={}, TransactionState={} status={}&quot;, transId, retState, retryTimes);</p> <p>​    return retState;</p> <p>}</p> <p>static class MessageConvertHelper extends MappingJackson2MessageConverter {</p> <p>​    private final static MessageConvertHelper converter;</p> <p>​    static{</p> <p>​      converter = new MessageConvertHelper();</p> <p>​    }</p> <p>​    public static Object convert(Message&lt;?&gt; message, Class&lt;?&gt; targetClass){</p> <p>​      return converter.convertFromInternal(message,targetClass,null);</p> <p>​    }</p> <ol><li>秒杀系统的压测</li></ol> <h2 id="_4-1-批量生成用户账户信息"><a href="#_4-1-批量生成用户账户信息" class="header-anchor">#</a> 4.1 批量生成用户账户信息</h2> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1595225442036-14539484-8ce2-49dd-9b77-e1d74ad5113a.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_54%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1595225442078-08f1809b-0011-4564-b9b0-2db12da43f21.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_51%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h2 id="_4-2-批量生成jwt-token"><a href="#_4-2-批量生成jwt-token" class="header-anchor">#</a> 4.2 批量生成JWT token</h2> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1595225442030-7c9f2e53-5976-418b-93a0-6c1d1ff03f49.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_52%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1595225442074-c3760f41-d53b-4e4a-82e9-f2d747e852c3.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_54%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1595225442210-81862fa7-551b-4ec9-a020-602e9061ce7c.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_35%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1595225442040-49c32116-4e8b-4387-994e-e0f65d0ef922.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_53%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h2 id="_4-3-jmeter设置config-data"><a href="#_4-3-jmeter设置config-data" class="header-anchor">#</a> 4.3 Jmeter设置config Data</h2> <p>设置jwt token变量名：Authorization</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1595225442140-4e784215-02c4-45d8-8661-6b890c7ba197.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_50%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h2 id="_4-4-设置请求head"><a href="#_4-4-设置请求head" class="header-anchor">#</a> 4.4 设置请求head</h2> <p>设置请求头</p> <p>Authorization： ${Authorization}</p> <p>Content-Type：application/json</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1595225442172-d20b9d41-1b3d-42e7-8aee-5b4a5b826cbb.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_49%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h2 id="_4-5-设置并发请求数"><a href="#_4-5-设置并发请求数" class="header-anchor">#</a> 4.5 设置并发请求数</h2> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1595225442066-d28b7cc2-af59-4a71-9587-0c62e18d36d5.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_39%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h2 id=""><a href="#" class="header-anchor">#</a></h2> <h2 id="_4-6-设置请求报文体"><a href="#_4-6-设置请求报文体" class="header-anchor">#</a> 4.6 设置请求报文体</h2> <p>请求URL : http://localhost:8888/order/secKill/generateOrder</p> <p>方法类型： post</p> <p>报文体： {</p> <p>&quot;itemIds&quot;: [</p> <p>27</p> <p>],</p> <p>&quot;memberReceiveAddressId&quot;: 1,</p> <p>&quot;payType&quot;: 1,</p> <p>&quot;couponId&quot;:2,</p> <p>&quot;useIntegration&quot;: 100</p> <p>}</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1595225442063-19359122-01c4-4195-8fdc-c22758d41f64.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_40%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h1 id="-2"><a href="#-2" class="header-anchor">#</a></h1> <h2 id="_4-7-清理redis缓存"><a href="#_4-7-清理redis缓存" class="header-anchor">#</a> 4.7 清理redis缓存</h2> <p>&gt; flushdb</p> <h1 id="-3"><a href="#-3" class="header-anchor">#</a></h1> <h2 id="_4-8-服务启动"><a href="#_4-8-服务启动" class="header-anchor">#</a> 4.8  服务启动</h2> <p>先后启动 luban-auth  ,luban-gateway,luban-member,luban-product,luban-order.</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1595225442210-9eb257e8-1cd2-42b7-96b3-68c2b3ec7397.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_51%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h2 id="_4-9-开启压测"><a href="#_4-9-开启压测" class="header-anchor">#</a> 4.9 开启压测</h2> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1595225442073-e360750c-c5bd-495a-ae68-86fa0f93bad7.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_53%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <ol><li>秒杀验证码流程</li></ol> <h2 id="_5-1-生成验证码"><a href="#_5-1-生成验证码" class="header-anchor">#</a> 5.1 生成验证码</h2> <h3 id="_5-1-1-创建验证码"><a href="#_5-1-1-创建验证码" class="header-anchor">#</a> 5.1.1 创建验证码</h3> <p>/**</p> <p>* 创建验证码</p> <p>*/</p> <p>public static VerifyCodeInfo createVerifyCode() {</p> <p>int width = 80;</p> <p>int height = 32;</p> <p>//create the image</p> <p>BufferedImage image = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);</p> <p>Graphics g = image.getGraphics();</p> <p>// set the background color</p> <p>g.setColor(new Color(0xDCDCDC));</p> <p>g.fillRect(0, 0, width, height);</p> <p>// draw the border</p> <p>g.setColor(Color.black);</p> <p>g.drawRect(0, 0, width - 1, height - 1);</p> <p>// create a random instance to generate the codes</p> <p>Random rdm = new Random();</p> <p>// make some confusion</p> <p>for (int i = 0; i &lt; 50; i++) {</p> <p>​    int x = rdm.nextInt(width);</p> <p>​    int y = rdm.nextInt(height);</p> <p>​    g.drawOval(x, y, 0, 0);</p> <p>}</p> <p>// generate a random code</p> <p>String verifyCode = generateVerifyCode(rdm);</p> <p>g.setColor(new Color(0, 100, 0));</p> <p>g.setFont(new Font(&quot;Candara&quot;, Font.BOLD, 24));</p> <p>g.drawString(verifyCode, 8, 24);</p> <p>g.dispose();</p> <p>//把验证码存到redis中</p> <p>Integer result = calc(verifyCode);</p> <p>if (result == null) {</p> <p>​    return null;</p> <p>}</p> <p>//输出结果</p> <p>return new VerifyCodeInfo(image,result);</p> <p>}</p> <h3 id="_5-1-2-验证码答案存储在redis"><a href="#_5-1-2-验证码答案存储在redis" class="header-anchor">#</a> 5.1.2 验证码答案存储在redis</h3> <p>@RequestMapping(value=&quot;/verifyCode&quot;, method=RequestMethod.GET)</p> <p>@ResponseBody</p> <p>public CommonResult getVerifyCode(HttpServletRequest request,</p> <p>​                 HttpServletResponse response,</p> <p>​                 @RequestParam(&quot;productId&quot;) Long productId,</p> <p>​                 @RequestHeader(&quot;memberId&quot;) Long memberId){</p> <p>try {</p> <p>​    VerifyCodeImgUtil.VerifyCodeInfo imageInfo = VerifyCodeImgUtil.createVerifyCode();</p> <p>​    log.info(&quot;验证码答案:{}&quot;,imageInfo.getResult());</p> <p>​    //todo 验证码答案写入到redis</p> <p>​    redisOpsUtil.set(RedisKeyPrefixConst.MIAOSHA_VERIFY_CODE_PREFIX + memberId + &quot;:&quot; + productId //全局唯一ID</p> <p>​        ,imageInfo.getResult()</p> <p>​        ,300</p> <p>​        ,TimeUnit.SECONDS);</p> <p>​    response.setHeader(&quot;Content-Type&quot;, &quot;image/jpeg&quot;);</p> <p>​    OutputStream out = response.getOutputStream();</p> <p>​    ImageIO.write(imageInfo.getBufferedImage(), &quot;JPEG&quot;, out);</p> <p>​    out.flush();</p> <p>​    out.close();</p> <p>​    return null;</p> <p>​    /**</p> <p>​     * 返回图片的base64编码,js解码成图片</p> <p>​     */</p> <p>​    /*ByteArrayOutputStream baos = new ByteArrayOutputStream();//io流</p> <p>​    ImageIO.write(imageInfo.getBufferedImage(), &quot;png&quot;, baos);//写入流中</p> <p>​    byte[] bytes = baos.toByteArray();//转换成字节</p> <p>​    BASE64Encoder encoder = new BASE64Encoder();</p> <p>​    String png_base64 =  encoder.encodeBuffer(bytes).trim();//转换成base64串</p> <p>​    png_base64 = png_base64.replaceAll(&quot;\n&quot;, &quot;&quot;).replaceAll(&quot;\r&quot;, &quot;&quot;);//删除 \r\n</p> <p>​    return CommonResult.success(png_base64);*/</p> <p>}catch(Exception e) {</p> <p>​    e.printStackTrace();</p> <p>​    return CommonResult.failed(&quot;秒杀失败&quot;);</p> <h3 id="_5-1-3-测试验证码生成"><a href="#_5-1-3-测试验证码生成" class="header-anchor">#</a> 5.1.3 测试验证码生成</h3> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1595225442074-9ba36259-9b96-443a-b0af-986aea369e62.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_53%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h2 id="_5-2-校验验证码"><a href="#_5-2-校验验证码" class="header-anchor">#</a> 5.2 校验验证码</h2> <h3 id="_5-2-1-提交验证码"><a href="#_5-2-1-提交验证码" class="header-anchor">#</a> 5.2.1 提交验证码</h3> <p>@RequestMapping(value=&quot;/token&quot;, method=RequestMethod.GET)</p> <p>@ResponseBody</p> <p>public CommonResult getMiaoshaToken(HttpServletRequest request</p> <p>​    , @RequestParam(&quot;productId&quot;) Long productId</p> <p>​    , @RequestHeader(&quot;memberId&quot;) Long memberId</p> <p>​    , @RequestParam Integer verifyCode) {</p> <p>/*</p> <p>* 用redis限流，限制接口1分钟最多访问10000次</p> <p>*/</p> <p>String requestURI = request.getRequestURI().toString();</p> <p>Long requestNum = redisOpsUtil.incr(requestURI);</p> <p>if (requestNum == 1) {</p> <p>​    redisOpsUtil.expire(requestURI,60, TimeUnit.SECONDS);</p> <p>} else if (requestNum &gt; 10000) {</p> <p>​    return CommonResult.failed(&quot;访问超载，请稍后再试&quot;);</p> <p>}</p> <p>String verifyCodeKey = RedisKeyPrefixConst.MIAOSHA_VERIFY_CODE_PREFIX + memberId + &quot;:&quot; + productId;</p> <p>/*</p> <p>* 校验验证码，防止接口被刷</p> <p>*/</p> <p>Integer redisCode = redisOpsUtil.get(verifyCodeKey,Integer.class);</p> <p>if(StringUtils.isEmpty(redisCode) || !redisCode.equals(verifyCode)) {</p> <p>​    return CommonResult.failed(&quot;验证码错误&quot;);</p> <p>}</p> <p>//验证成功,删除该验证码</p> <p>redisOpsUtil.delete(verifyCodeKey);</p> <p>//todo 创建token</p> <p>String token = MD5.md5(UUID.randomUUID().toString());</p> <p>log.info(&quot;miaosha token:{}&quot;,token);</p> <p>redisOpsUtil.set(RedisKeyPrefixConst.MIAOSHA_TOKEN_PREFIX + memberId + &quot;:&quot; + productId</p> <p>​      ,token</p> <p>​      ,300</p> <p>​      ,TimeUnit.SECONDS);</p> <p>return CommonResult.success(toke</p> <h3 id="_5-2-2-校验验证码答案"><a href="#_5-2-2-校验验证码答案" class="header-anchor">#</a> 5.2.2  校验验证码答案</h3> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1595225442340-f08f6c1c-7a8c-4de3-a603-ad61eb2e4ea5.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_53%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p></div></section> <footer class="page-edit"><!----> <!----></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:0;" data-v-ac050c62></ul></main></div> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="right:68px;bottom:290px;display:none;" data-v-5775ee02>
      欢迎来到我的博客
    </div> <div class="operation" style="right:90px;bottom:40px;display:;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:;" data-v-5775ee02></i></div> <canvas id="banniang" width="250" height="320" class="live2d" style="right:90px;bottom:-20px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    看板娘
  </div></div><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="https://assets.smallsunnyfox.com/music/2.mp3" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:200px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="https://assets.smallsunnyfox.com/music/2.jpg" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(https://assets.smallsunnyfox.com/music/2.jpg);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>강남역 4번 출구</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>Plastic / Fallin` Dild</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div><canvas id="vuepress-canvas-cursor"></canvas><!----><div class="RibbonAnimation"></div></div></div>
    <script src="/assets/js/app.8442cce6.js" defer></script><script src="/assets/js/3.fb47a76d.js" defer></script><script src="/assets/js/1.fc79f8d4.js" defer></script><script src="/assets/js/261.4033dba7.js" defer></script>
  </body>
</html>
