<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>电商微服务架构 | 编程印象</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="我盼世界无 bug">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.6ae13786.css" as="style"><link rel="preload" href="/assets/js/app.d06236b9.js" as="script"><link rel="preload" href="/assets/js/3.fb47a76d.js" as="script"><link rel="preload" href="/assets/js/1.fc79f8d4.js" as="script"><link rel="preload" href="/assets/js/298.b9aede0d.js" as="script"><link rel="prefetch" href="/assets/js/10.23520678.js"><link rel="prefetch" href="/assets/js/100.f14e46ac.js"><link rel="prefetch" href="/assets/js/101.33bf8b76.js"><link rel="prefetch" href="/assets/js/102.ea69b193.js"><link rel="prefetch" href="/assets/js/103.8da63847.js"><link rel="prefetch" href="/assets/js/104.310780b6.js"><link rel="prefetch" href="/assets/js/105.57ceea6b.js"><link rel="prefetch" href="/assets/js/106.354bcc81.js"><link rel="prefetch" href="/assets/js/107.425755c2.js"><link rel="prefetch" href="/assets/js/108.5dd7dbf5.js"><link rel="prefetch" href="/assets/js/109.9a2d543d.js"><link rel="prefetch" href="/assets/js/11.0dcebd6a.js"><link rel="prefetch" href="/assets/js/110.5cb73eda.js"><link rel="prefetch" href="/assets/js/111.7784cc53.js"><link rel="prefetch" href="/assets/js/112.7bd19e28.js"><link rel="prefetch" href="/assets/js/113.29637e48.js"><link rel="prefetch" href="/assets/js/114.b24981e1.js"><link rel="prefetch" href="/assets/js/115.05228632.js"><link rel="prefetch" href="/assets/js/116.d6511d16.js"><link rel="prefetch" href="/assets/js/117.9d426072.js"><link rel="prefetch" href="/assets/js/118.62810b97.js"><link rel="prefetch" href="/assets/js/119.af237b99.js"><link rel="prefetch" href="/assets/js/12.2643f370.js"><link rel="prefetch" href="/assets/js/120.6eabb51e.js"><link rel="prefetch" href="/assets/js/121.7aa49370.js"><link rel="prefetch" href="/assets/js/122.a5e7822e.js"><link rel="prefetch" href="/assets/js/123.c9046a64.js"><link rel="prefetch" href="/assets/js/124.9cd77c47.js"><link rel="prefetch" href="/assets/js/125.25c5ea9b.js"><link rel="prefetch" href="/assets/js/126.4904c19f.js"><link rel="prefetch" href="/assets/js/127.3c3668be.js"><link rel="prefetch" href="/assets/js/128.3fa13fbb.js"><link rel="prefetch" href="/assets/js/129.ef427645.js"><link rel="prefetch" href="/assets/js/13.679265fe.js"><link rel="prefetch" href="/assets/js/130.91880838.js"><link rel="prefetch" href="/assets/js/131.44e4bf8e.js"><link rel="prefetch" href="/assets/js/132.622844fc.js"><link rel="prefetch" href="/assets/js/133.f6a5d600.js"><link rel="prefetch" href="/assets/js/134.454338dd.js"><link rel="prefetch" href="/assets/js/135.bdd97d1f.js"><link rel="prefetch" href="/assets/js/136.22dbb32c.js"><link rel="prefetch" href="/assets/js/137.fc0bcd39.js"><link rel="prefetch" href="/assets/js/138.d7e0b974.js"><link rel="prefetch" href="/assets/js/139.d575e140.js"><link rel="prefetch" href="/assets/js/14.72aa3845.js"><link rel="prefetch" href="/assets/js/140.4a0dc494.js"><link rel="prefetch" href="/assets/js/141.c29e34a4.js"><link rel="prefetch" href="/assets/js/142.d7fba3cf.js"><link rel="prefetch" href="/assets/js/143.1210a112.js"><link rel="prefetch" href="/assets/js/144.53175840.js"><link rel="prefetch" href="/assets/js/145.44339ca0.js"><link rel="prefetch" href="/assets/js/146.337a1810.js"><link rel="prefetch" href="/assets/js/147.fc93f18f.js"><link rel="prefetch" href="/assets/js/148.ac58d172.js"><link rel="prefetch" href="/assets/js/149.f88c28b3.js"><link rel="prefetch" href="/assets/js/15.1aebc980.js"><link rel="prefetch" href="/assets/js/150.f43714eb.js"><link rel="prefetch" href="/assets/js/151.faa29a85.js"><link rel="prefetch" href="/assets/js/152.606ba9ed.js"><link rel="prefetch" href="/assets/js/153.34f65c91.js"><link rel="prefetch" href="/assets/js/154.37d467e2.js"><link rel="prefetch" href="/assets/js/155.0502fbad.js"><link rel="prefetch" href="/assets/js/156.e3504151.js"><link rel="prefetch" href="/assets/js/157.074b7eb0.js"><link rel="prefetch" href="/assets/js/158.0052c501.js"><link rel="prefetch" href="/assets/js/159.cd775410.js"><link rel="prefetch" href="/assets/js/16.5bc18964.js"><link rel="prefetch" href="/assets/js/160.80357ec1.js"><link rel="prefetch" href="/assets/js/161.8138e952.js"><link rel="prefetch" href="/assets/js/162.554470ad.js"><link rel="prefetch" href="/assets/js/163.d07985ce.js"><link rel="prefetch" href="/assets/js/164.f2cb7d41.js"><link rel="prefetch" href="/assets/js/165.647c0788.js"><link rel="prefetch" href="/assets/js/166.5bf25495.js"><link rel="prefetch" href="/assets/js/167.dc466369.js"><link rel="prefetch" href="/assets/js/168.f2e0973b.js"><link rel="prefetch" href="/assets/js/169.7fb5c6c0.js"><link rel="prefetch" href="/assets/js/17.165a37ea.js"><link rel="prefetch" href="/assets/js/170.675c59f1.js"><link rel="prefetch" href="/assets/js/171.028aacf4.js"><link rel="prefetch" href="/assets/js/172.d87e86b7.js"><link rel="prefetch" href="/assets/js/173.997ca0c6.js"><link rel="prefetch" href="/assets/js/174.497a9e73.js"><link rel="prefetch" href="/assets/js/175.f8d62c48.js"><link rel="prefetch" href="/assets/js/176.a04b254a.js"><link rel="prefetch" href="/assets/js/177.5b89afa6.js"><link rel="prefetch" href="/assets/js/178.f56dec27.js"><link rel="prefetch" href="/assets/js/179.c82edecd.js"><link rel="prefetch" href="/assets/js/18.683fd624.js"><link rel="prefetch" href="/assets/js/180.36c8ea69.js"><link rel="prefetch" href="/assets/js/181.5e966770.js"><link rel="prefetch" href="/assets/js/182.3b4bc8cf.js"><link rel="prefetch" href="/assets/js/183.1b13e7e6.js"><link rel="prefetch" href="/assets/js/184.becee66c.js"><link rel="prefetch" href="/assets/js/185.bc4e6882.js"><link rel="prefetch" href="/assets/js/186.a87a08e2.js"><link rel="prefetch" href="/assets/js/187.de80888c.js"><link rel="prefetch" href="/assets/js/188.b25fa9da.js"><link rel="prefetch" href="/assets/js/189.95bfd5d7.js"><link rel="prefetch" href="/assets/js/19.794d3e1a.js"><link rel="prefetch" href="/assets/js/190.2b7177b7.js"><link rel="prefetch" href="/assets/js/191.4a0d6e16.js"><link rel="prefetch" href="/assets/js/192.165ac097.js"><link rel="prefetch" href="/assets/js/193.1f8c6d9e.js"><link rel="prefetch" href="/assets/js/194.ee4cf2be.js"><link rel="prefetch" href="/assets/js/195.807a626a.js"><link rel="prefetch" href="/assets/js/196.78303e55.js"><link rel="prefetch" href="/assets/js/197.5e883d99.js"><link rel="prefetch" href="/assets/js/198.f5e60ee7.js"><link rel="prefetch" href="/assets/js/199.c9c78cf7.js"><link rel="prefetch" href="/assets/js/20.f2e0c1cd.js"><link rel="prefetch" href="/assets/js/200.19ffa750.js"><link rel="prefetch" href="/assets/js/201.8f7213bc.js"><link rel="prefetch" href="/assets/js/202.dedd4242.js"><link rel="prefetch" href="/assets/js/203.5dd068a5.js"><link rel="prefetch" href="/assets/js/204.d31a2169.js"><link rel="prefetch" href="/assets/js/205.c7c3a3f7.js"><link rel="prefetch" href="/assets/js/206.88c1ce28.js"><link rel="prefetch" href="/assets/js/207.d2fc9cd7.js"><link rel="prefetch" href="/assets/js/208.a18590a4.js"><link rel="prefetch" href="/assets/js/209.8639762d.js"><link rel="prefetch" href="/assets/js/21.e96cb5ef.js"><link rel="prefetch" href="/assets/js/210.2d82da3f.js"><link rel="prefetch" href="/assets/js/211.928ebbcc.js"><link rel="prefetch" href="/assets/js/212.137d78d9.js"><link rel="prefetch" href="/assets/js/213.d0180260.js"><link rel="prefetch" href="/assets/js/214.7ac05935.js"><link rel="prefetch" href="/assets/js/215.38dfe367.js"><link rel="prefetch" href="/assets/js/216.964ee825.js"><link rel="prefetch" href="/assets/js/217.baf23e50.js"><link rel="prefetch" href="/assets/js/218.524e9a47.js"><link rel="prefetch" href="/assets/js/219.0b8dfa50.js"><link rel="prefetch" href="/assets/js/22.3d982b1b.js"><link rel="prefetch" href="/assets/js/220.5ced77be.js"><link rel="prefetch" href="/assets/js/221.34a36a13.js"><link rel="prefetch" href="/assets/js/222.8cd0ff0e.js"><link rel="prefetch" href="/assets/js/223.480526dc.js"><link rel="prefetch" href="/assets/js/224.3849de74.js"><link rel="prefetch" href="/assets/js/225.bf93f1c5.js"><link rel="prefetch" href="/assets/js/226.f603fa7d.js"><link rel="prefetch" href="/assets/js/227.8427563e.js"><link rel="prefetch" href="/assets/js/228.5f9c1d5e.js"><link rel="prefetch" href="/assets/js/229.76107a54.js"><link rel="prefetch" href="/assets/js/23.8dd50c6b.js"><link rel="prefetch" href="/assets/js/230.f91d35cd.js"><link rel="prefetch" href="/assets/js/231.482a19ef.js"><link rel="prefetch" href="/assets/js/232.46af3d00.js"><link rel="prefetch" href="/assets/js/233.3f7d4fa3.js"><link rel="prefetch" href="/assets/js/234.5a82f8db.js"><link rel="prefetch" href="/assets/js/235.b2fd1bf7.js"><link rel="prefetch" href="/assets/js/236.b29d949e.js"><link rel="prefetch" href="/assets/js/237.483b4c2a.js"><link rel="prefetch" href="/assets/js/238.03779e5f.js"><link rel="prefetch" href="/assets/js/239.f5a9f3e4.js"><link rel="prefetch" href="/assets/js/24.5d408001.js"><link rel="prefetch" href="/assets/js/240.52b2b13c.js"><link rel="prefetch" href="/assets/js/241.cd1469c4.js"><link rel="prefetch" href="/assets/js/242.b95eab15.js"><link rel="prefetch" href="/assets/js/243.3020bb0c.js"><link rel="prefetch" href="/assets/js/244.72c2a382.js"><link rel="prefetch" href="/assets/js/245.eb150649.js"><link rel="prefetch" href="/assets/js/246.9d5bd946.js"><link rel="prefetch" href="/assets/js/247.609c161b.js"><link rel="prefetch" href="/assets/js/248.481b8a04.js"><link rel="prefetch" href="/assets/js/249.97aac380.js"><link rel="prefetch" href="/assets/js/25.7439f4da.js"><link rel="prefetch" href="/assets/js/250.3d25ba77.js"><link rel="prefetch" href="/assets/js/251.4d26083e.js"><link rel="prefetch" href="/assets/js/252.fee391d1.js"><link rel="prefetch" href="/assets/js/253.9d63637a.js"><link rel="prefetch" href="/assets/js/254.83efbfbc.js"><link rel="prefetch" href="/assets/js/255.bfcf8976.js"><link rel="prefetch" href="/assets/js/256.c475b5a7.js"><link rel="prefetch" href="/assets/js/257.685f6f29.js"><link rel="prefetch" href="/assets/js/258.f5bdddc8.js"><link rel="prefetch" href="/assets/js/259.a9b39e80.js"><link rel="prefetch" href="/assets/js/26.ba4cf6d9.js"><link rel="prefetch" href="/assets/js/260.2378def4.js"><link rel="prefetch" href="/assets/js/261.165fd6b3.js"><link rel="prefetch" href="/assets/js/262.35354dca.js"><link rel="prefetch" href="/assets/js/263.2d86ab03.js"><link rel="prefetch" href="/assets/js/264.1b5f09dc.js"><link rel="prefetch" href="/assets/js/265.b027d303.js"><link rel="prefetch" href="/assets/js/266.4d18c281.js"><link rel="prefetch" href="/assets/js/267.a1859863.js"><link rel="prefetch" href="/assets/js/268.386b764d.js"><link rel="prefetch" href="/assets/js/269.fabe3586.js"><link rel="prefetch" href="/assets/js/27.f1802804.js"><link rel="prefetch" href="/assets/js/270.bbb5aa61.js"><link rel="prefetch" href="/assets/js/271.6a2a3252.js"><link rel="prefetch" href="/assets/js/272.84a31b13.js"><link rel="prefetch" href="/assets/js/273.a03fcfca.js"><link rel="prefetch" href="/assets/js/274.ac133a12.js"><link rel="prefetch" href="/assets/js/275.aea3c18f.js"><link rel="prefetch" href="/assets/js/276.43b16849.js"><link rel="prefetch" href="/assets/js/277.31b13006.js"><link rel="prefetch" href="/assets/js/278.945891c3.js"><link rel="prefetch" href="/assets/js/279.18a7e72e.js"><link rel="prefetch" href="/assets/js/28.77cda693.js"><link rel="prefetch" href="/assets/js/280.f0ff2a4f.js"><link rel="prefetch" href="/assets/js/281.71f54ace.js"><link rel="prefetch" href="/assets/js/282.facdee6c.js"><link rel="prefetch" href="/assets/js/283.d165835d.js"><link rel="prefetch" href="/assets/js/284.68ddbe0d.js"><link rel="prefetch" href="/assets/js/285.0721931e.js"><link rel="prefetch" href="/assets/js/286.5d9eb995.js"><link rel="prefetch" href="/assets/js/287.95d7e9fd.js"><link rel="prefetch" href="/assets/js/288.f5a4edb2.js"><link rel="prefetch" href="/assets/js/289.6101981f.js"><link rel="prefetch" href="/assets/js/29.ce2567a2.js"><link rel="prefetch" href="/assets/js/290.9293a108.js"><link rel="prefetch" href="/assets/js/291.0733633f.js"><link rel="prefetch" href="/assets/js/292.59bf4655.js"><link rel="prefetch" href="/assets/js/293.bd46306a.js"><link rel="prefetch" href="/assets/js/294.d69f140b.js"><link rel="prefetch" href="/assets/js/295.f325734e.js"><link rel="prefetch" href="/assets/js/296.e8053753.js"><link rel="prefetch" href="/assets/js/297.a0b7b0b5.js"><link rel="prefetch" href="/assets/js/299.84b8dbd3.js"><link rel="prefetch" href="/assets/js/30.6f17749b.js"><link rel="prefetch" href="/assets/js/300.42a96b79.js"><link rel="prefetch" href="/assets/js/301.a1d8aa4f.js"><link rel="prefetch" href="/assets/js/302.fdc7a53b.js"><link rel="prefetch" href="/assets/js/303.dbb0a499.js"><link rel="prefetch" href="/assets/js/304.bca03832.js"><link rel="prefetch" href="/assets/js/305.88b60825.js"><link rel="prefetch" href="/assets/js/306.0f9e47a1.js"><link rel="prefetch" href="/assets/js/307.52614edb.js"><link rel="prefetch" href="/assets/js/308.a071a464.js"><link rel="prefetch" href="/assets/js/309.2a3946cd.js"><link rel="prefetch" href="/assets/js/31.592f70a1.js"><link rel="prefetch" href="/assets/js/310.02e41d92.js"><link rel="prefetch" href="/assets/js/311.88362100.js"><link rel="prefetch" href="/assets/js/312.69ac5ee4.js"><link rel="prefetch" href="/assets/js/313.887f39e6.js"><link rel="prefetch" href="/assets/js/314.2e321e9e.js"><link rel="prefetch" href="/assets/js/315.a2bcb728.js"><link rel="prefetch" href="/assets/js/316.0fad8ec0.js"><link rel="prefetch" href="/assets/js/317.8b58f94b.js"><link rel="prefetch" href="/assets/js/318.c1871fe4.js"><link rel="prefetch" href="/assets/js/319.86b8d0c5.js"><link rel="prefetch" href="/assets/js/32.e4555f39.js"><link rel="prefetch" href="/assets/js/320.5a320fd2.js"><link rel="prefetch" href="/assets/js/321.67d4e7f4.js"><link rel="prefetch" href="/assets/js/322.d64278f0.js"><link rel="prefetch" href="/assets/js/323.36dad4fd.js"><link rel="prefetch" href="/assets/js/33.6672f7e7.js"><link rel="prefetch" href="/assets/js/34.42fca069.js"><link rel="prefetch" href="/assets/js/35.74584314.js"><link rel="prefetch" href="/assets/js/36.ad136ea8.js"><link rel="prefetch" href="/assets/js/37.8c77c84a.js"><link rel="prefetch" href="/assets/js/38.45fb46a1.js"><link rel="prefetch" href="/assets/js/39.e82ef2d8.js"><link rel="prefetch" href="/assets/js/4.35359649.js"><link rel="prefetch" href="/assets/js/40.da417425.js"><link rel="prefetch" href="/assets/js/41.9ddbd011.js"><link rel="prefetch" href="/assets/js/42.c186e139.js"><link rel="prefetch" href="/assets/js/43.a01382a6.js"><link rel="prefetch" href="/assets/js/44.d4f0802f.js"><link rel="prefetch" href="/assets/js/45.cd23612d.js"><link rel="prefetch" href="/assets/js/46.55f55d53.js"><link rel="prefetch" href="/assets/js/47.dfb31492.js"><link rel="prefetch" href="/assets/js/48.3f653788.js"><link rel="prefetch" href="/assets/js/49.835c6afd.js"><link rel="prefetch" href="/assets/js/5.6361159c.js"><link rel="prefetch" href="/assets/js/50.e7a70ca0.js"><link rel="prefetch" href="/assets/js/51.42b42dc8.js"><link rel="prefetch" href="/assets/js/52.33e39b59.js"><link rel="prefetch" href="/assets/js/53.b9c989f8.js"><link rel="prefetch" href="/assets/js/54.291f55eb.js"><link rel="prefetch" href="/assets/js/55.1cb672ce.js"><link rel="prefetch" href="/assets/js/56.a0c63e01.js"><link rel="prefetch" href="/assets/js/57.276251b9.js"><link rel="prefetch" href="/assets/js/58.5f1a5d00.js"><link rel="prefetch" href="/assets/js/59.4a6aa29b.js"><link rel="prefetch" href="/assets/js/6.6b20e148.js"><link rel="prefetch" href="/assets/js/60.a316669c.js"><link rel="prefetch" href="/assets/js/61.83e38aa6.js"><link rel="prefetch" href="/assets/js/62.b8f2a2d8.js"><link rel="prefetch" href="/assets/js/63.447cc58c.js"><link rel="prefetch" href="/assets/js/64.f43b4684.js"><link rel="prefetch" href="/assets/js/65.cb4f240e.js"><link rel="prefetch" href="/assets/js/66.b6f03b53.js"><link rel="prefetch" href="/assets/js/67.7d58ed84.js"><link rel="prefetch" href="/assets/js/68.79ba5fc8.js"><link rel="prefetch" href="/assets/js/69.1096d6ce.js"><link rel="prefetch" href="/assets/js/7.e9deccd6.js"><link rel="prefetch" href="/assets/js/70.6ecf5095.js"><link rel="prefetch" href="/assets/js/71.25959f1d.js"><link rel="prefetch" href="/assets/js/72.3e104890.js"><link rel="prefetch" href="/assets/js/73.020f927c.js"><link rel="prefetch" href="/assets/js/74.9a62b366.js"><link rel="prefetch" href="/assets/js/75.eeaad731.js"><link rel="prefetch" href="/assets/js/76.ee9c29f4.js"><link rel="prefetch" href="/assets/js/77.50cae5f1.js"><link rel="prefetch" href="/assets/js/78.ba032fb3.js"><link rel="prefetch" href="/assets/js/79.4f6544e3.js"><link rel="prefetch" href="/assets/js/8.6d109cee.js"><link rel="prefetch" href="/assets/js/80.1a6416b9.js"><link rel="prefetch" href="/assets/js/81.72e0d35f.js"><link rel="prefetch" href="/assets/js/82.136e461c.js"><link rel="prefetch" href="/assets/js/83.f960be3d.js"><link rel="prefetch" href="/assets/js/84.08f80a96.js"><link rel="prefetch" href="/assets/js/85.34a823fb.js"><link rel="prefetch" href="/assets/js/86.a02809c9.js"><link rel="prefetch" href="/assets/js/87.776c4c93.js"><link rel="prefetch" href="/assets/js/88.471c31a5.js"><link rel="prefetch" href="/assets/js/89.796753e6.js"><link rel="prefetch" href="/assets/js/9.28ad0904.js"><link rel="prefetch" href="/assets/js/90.b1c03e12.js"><link rel="prefetch" href="/assets/js/91.0b995c01.js"><link rel="prefetch" href="/assets/js/92.ae6243c4.js"><link rel="prefetch" href="/assets/js/93.8eb2677c.js"><link rel="prefetch" href="/assets/js/94.e611a133.js"><link rel="prefetch" href="/assets/js/95.0985510d.js"><link rel="prefetch" href="/assets/js/96.c42ee87e.js"><link rel="prefetch" href="/assets/js/97.dd6aee3a.js"><link rel="prefetch" href="/assets/js/98.3cf9fc70.js"><link rel="prefetch" href="/assets/js/99.4aa5a270.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6ae13786.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-5bb33761><div data-v-5bb33761><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-5bb33761 data-v-5bb33761><h3 class="title" data-v-59e6cb88>编程印象</h3> <p class="description" data-v-59e6cb88>我盼世界无 bug</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>panfeng</span>
          
        <span data-v-59e6cb88>2017 - </span>
        2023
      </a></span></div></div> <div class="hide" data-v-5bb33761><header class="navbar" data-v-5bb33761><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="编程印象" class="logo"> <span class="site-name">编程印象</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/数据库/" class="nav-link"><i class="undefined"></i>
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/categories/Devops/" class="nav-link"><i class="undefined"></i>
  Devops
</a></li><li class="dropdown-item"><!----> <a href="/categories/javaSE专题/" class="nav-link"><i class="undefined"></i>
  javaSE专题
</a></li><li class="dropdown-item"><!----> <a href="/categories/java后台框架/" class="nav-link"><i class="undefined"></i>
  java后台框架
</a></li><li class="dropdown-item"><!----> <a href="/categories/java底层专题/" class="nav-link"><i class="undefined"></i>
  java底层专题
</a></li><li class="dropdown-item"><!----> <a href="/categories/分布式/" class="nav-link"><i class="undefined"></i>
  分布式
</a></li><li class="dropdown-item"><!----> <a href="/categories/java/" class="nav-link"><i class="undefined"></i>
  java
</a></li><li class="dropdown-item"><!----> <a href="/categories/微服务/" class="nav-link"><i class="undefined"></i>
  微服务
</a></li><li class="dropdown-item"><!----> <a href="/categories/服务器/" class="nav-link"><i class="undefined"></i>
  服务器
</a></li><li class="dropdown-item"><!----> <a href="/categories/金三银四/" class="nav-link"><i class="undefined"></i>
  金三银四
</a></li><li class="dropdown-item"><!----> <a href="/categories/python/" class="nav-link"><i class="undefined"></i>
  python
</a></li><li class="dropdown-item"><!----> <a href="/categories/frontInterviewQuestions/" class="nav-link"><i class="undefined"></i>
  frontInterviewQuestions
</a></li><li class="dropdown-item"><!----> <a href="/categories/css/" class="nav-link"><i class="undefined"></i>
  css
</a></li><li class="dropdown-item"><!----> <a href="/categories/html/" class="nav-link"><i class="undefined"></i>
  html
</a></li><li class="dropdown-item"><!----> <a href="/categories/js/" class="nav-link"><i class="undefined"></i>
  js
</a></li><li class="dropdown-item"><!----> <a href="/categories/ts/" class="nav-link"><i class="undefined"></i>
  ts
</a></li><li class="dropdown-item"><!----> <a href="/categories/miniProgram/" class="nav-link"><i class="undefined"></i>
  miniProgram
</a></li><li class="dropdown-item"><!----> <a href="/categories/node/" class="nav-link"><i class="undefined"></i>
  node
</a></li><li class="dropdown-item"><!----> <a href="/categories/vue/" class="nav-link"><i class="undefined"></i>
  vue
</a></li><li class="dropdown-item"><!----> <a href="/categories/uniapp/" class="nav-link"><i class="undefined"></i>
  uniapp
</a></li><li class="dropdown-item"><!----> <a href="/categories/webpack/" class="nav-link"><i class="undefined"></i>
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/categories/QYWX/" class="nav-link"><i class="undefined"></i>
  QYWX
</a></li><li class="dropdown-item"><!----> <a href="/categories/项目实战/" class="nav-link"><i class="undefined"></i>
  项目实战
</a></li><li class="dropdown-item"><!----> <a href="/categories/linux/" class="nav-link"><i class="undefined"></i>
  linux
</a></li><li class="dropdown-item"><!----> <a href="/categories/版本工具/" class="nav-link"><i class="undefined"></i>
  版本工具
</a></li><li class="dropdown-item"><!----> <a href="/categories/包管理工具/" class="nav-link"><i class="undefined"></i>
  包管理工具
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      工具推荐
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://codesandbox.io" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  codeSandbox
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://24kcs.github.io/vue3_study/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  vue3+TS
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://tool.oschina.net/uploads/apidocs/jquery/regexp.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  正则表达式手册
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://caniuse.com/?search=flex" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  兼容性查询(前端)
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://httpbin.org/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  API请求测试
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://ps.gaoding.com/#/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  在线PS
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.tiobe.com/tiobe-index/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  编程语言排行榜
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.remove.bg/zh" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  一键去除背景
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://snippet-generator.app/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  快速生成代码片段
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      关于
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/pf_java_development" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-mayun"></i>
  码云
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-5bb33761></div> <aside class="sidebar" data-v-5bb33761><div class="personal-info-wrapper" data-v-1fad0c41 data-v-5bb33761><img src="/avatar.png" alt="author-avatar" class="personal-img" data-v-1fad0c41> <h3 class="name" data-v-1fad0c41>
    panfeng
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>313</h3> <h6 data-v-1fad0c41>Articles</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>63</h3> <h6 data-v-1fad0c41>Tags</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/数据库/" class="nav-link"><i class="undefined"></i>
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/categories/Devops/" class="nav-link"><i class="undefined"></i>
  Devops
</a></li><li class="dropdown-item"><!----> <a href="/categories/javaSE专题/" class="nav-link"><i class="undefined"></i>
  javaSE专题
</a></li><li class="dropdown-item"><!----> <a href="/categories/java后台框架/" class="nav-link"><i class="undefined"></i>
  java后台框架
</a></li><li class="dropdown-item"><!----> <a href="/categories/java底层专题/" class="nav-link"><i class="undefined"></i>
  java底层专题
</a></li><li class="dropdown-item"><!----> <a href="/categories/分布式/" class="nav-link"><i class="undefined"></i>
  分布式
</a></li><li class="dropdown-item"><!----> <a href="/categories/java/" class="nav-link"><i class="undefined"></i>
  java
</a></li><li class="dropdown-item"><!----> <a href="/categories/微服务/" class="nav-link"><i class="undefined"></i>
  微服务
</a></li><li class="dropdown-item"><!----> <a href="/categories/服务器/" class="nav-link"><i class="undefined"></i>
  服务器
</a></li><li class="dropdown-item"><!----> <a href="/categories/金三银四/" class="nav-link"><i class="undefined"></i>
  金三银四
</a></li><li class="dropdown-item"><!----> <a href="/categories/python/" class="nav-link"><i class="undefined"></i>
  python
</a></li><li class="dropdown-item"><!----> <a href="/categories/frontInterviewQuestions/" class="nav-link"><i class="undefined"></i>
  frontInterviewQuestions
</a></li><li class="dropdown-item"><!----> <a href="/categories/css/" class="nav-link"><i class="undefined"></i>
  css
</a></li><li class="dropdown-item"><!----> <a href="/categories/html/" class="nav-link"><i class="undefined"></i>
  html
</a></li><li class="dropdown-item"><!----> <a href="/categories/js/" class="nav-link"><i class="undefined"></i>
  js
</a></li><li class="dropdown-item"><!----> <a href="/categories/ts/" class="nav-link"><i class="undefined"></i>
  ts
</a></li><li class="dropdown-item"><!----> <a href="/categories/miniProgram/" class="nav-link"><i class="undefined"></i>
  miniProgram
</a></li><li class="dropdown-item"><!----> <a href="/categories/node/" class="nav-link"><i class="undefined"></i>
  node
</a></li><li class="dropdown-item"><!----> <a href="/categories/vue/" class="nav-link"><i class="undefined"></i>
  vue
</a></li><li class="dropdown-item"><!----> <a href="/categories/uniapp/" class="nav-link"><i class="undefined"></i>
  uniapp
</a></li><li class="dropdown-item"><!----> <a href="/categories/webpack/" class="nav-link"><i class="undefined"></i>
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/categories/QYWX/" class="nav-link"><i class="undefined"></i>
  QYWX
</a></li><li class="dropdown-item"><!----> <a href="/categories/项目实战/" class="nav-link"><i class="undefined"></i>
  项目实战
</a></li><li class="dropdown-item"><!----> <a href="/categories/linux/" class="nav-link"><i class="undefined"></i>
  linux
</a></li><li class="dropdown-item"><!----> <a href="/categories/版本工具/" class="nav-link"><i class="undefined"></i>
  版本工具
</a></li><li class="dropdown-item"><!----> <a href="/categories/包管理工具/" class="nav-link"><i class="undefined"></i>
  包管理工具
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      工具推荐
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://codesandbox.io" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  codeSandbox
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://24kcs.github.io/vue3_study/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  vue3+TS
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://tool.oschina.net/uploads/apidocs/jquery/regexp.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  正则表达式手册
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://caniuse.com/?search=flex" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  兼容性查询(前端)
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://httpbin.org/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  API请求测试
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://ps.gaoding.com/#/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  在线PS
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.tiobe.com/tiobe-index/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  编程语言排行榜
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.remove.bg/zh" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  一键去除背景
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://snippet-generator.app/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  快速生成代码片段
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      关于
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/pf_java_development" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-mayun"></i>
  码云
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-5bb33761><h3 class="title" data-v-59e6cb88>电商微服务架构</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>panfeng</span>
          
        <span data-v-59e6cb88>2017 - </span>
        2023
      </a></span></div></div> <div data-v-5bb33761><div data-v-5bb33761><main class="page" style="padding-right:0;"><section style="display:;"><div class="page-title"><h1 class="title">电商微服务架构</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>panfeng</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>8/15/2021</span></i> <!----> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>电商</span></i></div></div> <div class="theme-reco-content content__default"><h1 id="电商微服务架构"><a href="#电商微服务架构" class="header-anchor">#</a> <strong>电商微服务架构</strong></h1> <h1 id="_1-架构的演进"><a href="#_1-架构的演进" class="header-anchor">#</a> 1.架构的演进</h1> <h2 id="_1-1-单体架构"><a href="#_1-1-单体架构" class="header-anchor">#</a> 1.1 单体架构</h2> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620117746-d2662ca7-9c72-4f33-8cb1-6134e4c794d7.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_25%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <p>优点：</p> <p>1.应用开发简单</p> <p>2.易于对应用程序进行大规模的更改</p> <p>3.测试相对简单直观</p> <p>4.部署简单明了</p> <p>缺点：</p> <p>1.业务越来越复杂，单体架构扩展性不足，业务扩展带来的代价越来越大；</p> <p>2.用户越来越多，程序承受的并发越爱越高，单体应用的并发能力有限；</p> <p>3.单体应用的业务都在同一个程序中，增删改业务修改，也会影响其他代码，给测试增加了难度</p> <ol><li>扩展伸缩能力差</li></ol> <h2 id="_1-2-微服务"><a href="#_1-2-微服务" class="header-anchor">#</a> 1.2 微服务</h2> <p>Martin Flowers 微服务经典文章</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013633-9535b991-9964-43bb-b489-1ebff9471db0.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_10%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <p>https://martinfowler.com/articles/microservices.html</p> <h3 id="_1-2-1-什么是微服务"><a href="#_1-2-1-什么是微服务" class="header-anchor">#</a> 1.2.1 什么是微服务</h3> <p>微服务是一种开发软件的架构和组织方法，其中软件由通过明确定义的 API 进行通信的小型独立服务组成。这些服务由各个小型独立团队负责。微服务架构使应用程序更易于扩展和更快地开发，从而加速创新并缩短新功能的上市时间。</p> <h3 id=""><a href="#" class="header-anchor">#</a></h3> <h3 id="_1-2-2-整体式架构与微服务架构"><a href="#_1-2-2-整体式架构与微服务架构" class="header-anchor">#</a> 1.2.2 整体式架构与微服务架构</h3> <p>通过整体式架构，所有进程紧密耦合，并可作为单项服务运行。这意味着，如果应用程序的一个进程遇到需求峰值，则必须扩展整个架构。随着代码库的增长，添加或改进整体式应用程序的功能变得更加复杂。这种复杂性限制了试验的可行性，并使实施新概念变得困难。整体式架构增加了应用程序可用性的风险，因为许多依赖且紧密耦合的进程会扩大单个进程故障的影响。</p> <p>使用微服务架构，将应用程序构建为独立的组件，并将每个应用程序进程作为一项服务运行。这些服务使用轻量级 API 通过明确定义的接口进行通信。这些服务是围绕业务功能构建的，每项服务执行一项功能。由于它们是独立运行的，因此可以针对各项服务进行更新、部署和扩展，以满足对应用程序特定功能的需求。</p> <h3 id="_1-2-3-微服务的特性"><a href="#_1-2-3-微服务的特性" class="header-anchor">#</a> 1.2.3 微服务的特性</h3> <p>自主性</p> <h3 id="-2"><a href="#-2" class="header-anchor">#</a> <img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013674-acb72959-ba4b-40d3-bf96-19e176d7a17c.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_10%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></h3> <p>可以对微服务架构中的每个组件服务进行开发、部署、运营和扩展，而不影响其他服务的功能。这些服务不需要与其他服务共享任何代码或实施。各个组件之间的任何通信都是通过明确定义的 API 进行的。</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013732-68b19bf9-a639-46d5-a091-2daf0b873bcf.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_9%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <p>专用性</p> <p>每项服务都是针对一组功能而设计的，并专注于解决特定的问题。如果开发人员逐渐将更多代码增加到一项服务中并且这项服务变得复杂，那么可以将其拆分成多项更小的服务。</p> <h3 id="_1-2-4-微服务的优势"><a href="#_1-2-4-微服务的优势" class="header-anchor">#</a> 1.2.4 微服务的优势</h3> <p><strong>敏捷性</strong></p> <p>微服务促进若干小型独立团队形成一个组织，这些团队负责自己的服务。各团队在小型且易于理解的环境中行事，并且可以更独立、更快速地工作。这缩短了开发周期时间。您可以从组织的总吞吐量中显著获益。</p> <p><strong>灵活扩展</strong></p> <p>通过微服务，您可以独立扩展各项服务以满足其支持的应用程序功能的需求。这使团队能够适当调整基础设施需求，准确衡量功能成本，并在服务需求激增时保持可用性。</p> <p><strong>轻松部署</strong></p> <p>微服务支持持续集成和持续交付，可以轻松尝试新想法，并可以在无法正常运行时回滚。由于故障成本较低，因此可以大胆试验，更轻松地更新代码，并缩短新功能的上市时间。</p> <p><strong>技术自由</strong></p> <p>微服务架构不遵循“一刀切”的方法。团队可以自由选择最佳工具来解决他们的具体问题。因此，构建微服务的团队可以为每项作业选择最佳工具。</p> <p><strong>可重复使用的代码</strong></p> <p>将软件划分为小型且明确定义的模块，让团队可以将功能用于多种目的。专为某项功能编写的服务可以用作另一项功能的构建块。这样应用程序就可以自行引导，因为开发人员可以创建新功能，而无需从头开始编写代码。</p> <p><strong>弹性</strong></p> <p>服务独立性增加了应用程序应对故障的弹性。在整体式架构中，如果一个组件出现故障，可能导致整个应用程序无法运行。通过微服务，应用程序可以通过降低功能而不导致整个应用程序崩溃来处理总体服务故障。</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013744-d1e8bbc5-7934-4c8f-871c-6aa467328ca4.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_27%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h3 id="_1-2-5-微服务的劣势"><a href="#_1-2-5-微服务的劣势" class="header-anchor">#</a> 1.2.5 微服务的劣势</h3> <p>分发：分布式系统更难编程，因为远程调用速度慢，并且总是有失败的风险。</p> <p>最终一致性：对于分布式系统来说，维护强大的一致性是极其困难的，这意味着每个人都必须管理最终一致性。</p> <p>操作复杂性：您需要一个成熟的操作团队来管理大量的服务，这些服务正在定期重新部署。</p> <h2 id="_1-3-微服务划分"><a href="#_1-3-微服务划分" class="header-anchor">#</a> 1.3 微服务划分</h2> <p>如何将单体服务拆分微服务？什么时候拆分？拆成什么？</p> <p>https://martinfowler.com/articles/break-monolith-into-microservices.html</p> <h3 id="_1-3-1-从边缘服务开始拆分"><a href="#_1-3-1-从边缘服务开始拆分" class="header-anchor">#</a> 1.3.1 从边缘服务开始拆分</h3> <p>比如把认证服务进行拆分</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013703-8666c192-29c4-4b15-b30a-a22f7a8a7c1d.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_15%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h3 id="_1-3-2-减少对老系统的依赖"><a href="#_1-3-2-减少对老系统的依赖" class="header-anchor">#</a> 1.3.2  减少对老系统的依赖</h3> <p>将新的微服务系统与老系统之间的依赖关系最小化是一个基本原则。微服务的一个主要优点是具有快速和独立的发布周期。一旦与老系统之间有任何依赖，如数据、逻辑或API，都将导致微服务系统与老系统的发布周期相耦合，从而使得微服务的发布优势不复存在。通常，摆脱老系统的主要动机就是其成本之高昂，以及深锁于其中的业务功能的更新之缓慢。所以，我们希望逐步通过减少对老系统的依赖关系的方式，将核心业务解耦。如果团队能够遵循这些原则，将业务功能写进自己的服务中，依赖关系就能从对单体系统的依赖转变为对微服务的依赖。这是一个理想的依赖方向，因为它将不会拖慢新服务的更新速度。</p> <p>如果新服务最终依然还是调用到了老系统，我建议在老系统中开发新的API，并通过新服务的访问层来访问这些API，以确保老系统中的业务逻辑不会直接暴露出来。就算老系统的内部可能实现并不是这样的，也应该致力于定义一个能够反应领域的明确概念和其结构的API。</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013693-86214ae1-d3c7-4549-98d2-42c45bc35a03.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_24%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h3 id="_1-3-3-解耦粘性功能"><a href="#_1-3-3-解耦粘性功能" class="header-anchor">#</a> 1.3.3  解耦粘性功能</h3> <p>往往是因为在整体架构中的某个功能模块的设计上存在问题，没有被很好地定义为领域概念，导致系统中大量的功能都依赖于它。为了能够将解耦进行下去，开发人员需要识别出这些“粘性功能(Sticky Capabilities)”，将其解构为拥有良好定义的领域概念，并将这些领域概念转化为单独的服务。</p> <p>比如在一个网站的单体系统中，会话（Session）是最常见的耦合因素之一。在在线零售系统的示例中，Session中通常存放着许多东西，从跨越了多个域边界的用户偏好（比如物流和支付的偏好设置）到用户的意图和用户交互（比如最近访问的页面，浏览过的产品和愿望清单）。如果我们不进行解耦、重构当前的会话概念，我们将很难解耦剩下的更多功能，因为它们通过四处弥漫着的Session与老系统紧紧地耦合在了一起。 同时，我也不鼓励在整体框架之外另外创建一个“会话”服务，因为它只会导致类似的强耦合。相比之下，目前这种耦合关系仅存在于整体的业务流程之中，更糟糕的是，让它散布到业务流程之外乃至整个网络中。</p> <p>我们可以逐步地从粘性功能中将微服务提取出来，即一次只提供一个服务。找到最多的耦合概念并将其解耦重构为具体的领域服务</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013742-21823686-7df9-4651-9a60-d5ce56dd1166.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_27%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h3 id="_1-3-4-垂直解耦并且提前释放数据"><a href="#_1-3-4-垂直解耦并且提前释放数据" class="header-anchor">#</a> 1.3.4 垂直解耦并且提前释放数据</h3> <p>垂直地分离各个业务功能，连业务逻辑带数据一起进行解耦，并且各个前端应用的调用重定向到新的API上.</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013669-4b6a3d57-ca04-4329-8ef1-7acf36b862d9.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_31%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h3 id="_1-3-5-解耦重要而易变的业务功能"><a href="#_1-3-5-解耦重要而易变的业务功能" class="header-anchor">#</a> 1.3.5 解耦重要而易变的业务功能</h3> <p>从单体系统中将业务功能解耦出来是一件很难的事情。我听说，Neal Ford将其比作“一台小心翼翼的器官手术”。从在线零售系统中提取业务功能时，需要仔细地将业务逻辑、数据、UI组件提取出来并将它们重定向到新服务。因为其所需的工作量不是一点两点，所以开发者们需要不断地评估进行解耦的成本与其能够带来的好处，比如，是想要追求更快的开发速度，还是要追求规模上的成长。举个例子，如果交付团队的目标是想在修改单体系统中的现有业务功能时耗时更少，那么他们必须找到修改最耗时的业务功能并将其分离。把代码中不断发生变化的部分单独分离出来，可以最快速地产出价值。交付团队还可以通过对代码的提交记录做分析，找到那些变化得最多的部分，并将其与产品路线图、产品组合一起分析，以确定在将来最期望的功能，并将其分离出来。他们需要与业务经理、产品经理一起交谈，以了解对他们而言真正重要的差异化能力。</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013668-ee9eb77c-269a-4ad8-b37e-f404f6b31301.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_18%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h3 id="_1-3-6-解耦业务功能-不是解耦业务代码"><a href="#_1-3-6-解耦业务功能-不是解耦业务代码" class="header-anchor">#</a> 1.3.6 解耦业务功能，不是解耦业务代码</h3> <p><strong>解耦服务时到底是重写还是重用？</strong></p> <p>无论何时，只要开发人员想要从系统中解耦一项服务出来，他们都有两种可行的办法：提取代码，或是直接重写。一般来说，服务的提取，或是单体系统的解构都默认被设想为是通过重用现有的实现方案并将其提取到单独的服务中来实现。其中的部分原因是因为，我们对我们所亲自设计和编写的出来的代码有着认知偏好。</p> <p>比如说，在零售系统中，“定价和促销”功能是一段相当复杂的高难度代码，它可以动态地配置和应用促销规则，并且根据各种参数（例如客户行为，忠诚度，产品捆绑等）提供折扣和优惠。像“定价和促销”这样的业务功能，就是进行“重用及提取”的完美选择。而相比之下，“客户信息”就是一个很简单的CRUD功能点，主要也就包括序列化、数据存储以及相关配置之类的一些模板功能，因此，它是进行“重写和淘汰”的理想对象。</p> <p>待解耦的业务功能与清晰的领域概念相一致，并且逻辑精巧复杂，否则我强烈建议进行重写，并淘汰老代码。</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013710-01116792-a25d-4cda-a4d8-efb36b964c47.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_26%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h3 id="_1-3-7-先宏观再微观"><a href="#_1-3-7-先宏观再微观" class="header-anchor">#</a> 1.3.7 先宏观再微观</h3> <p>从遗留单体系统中寻找领域边界，既是一门艺术，又是一门科学。而作为一个具有普适性的规则，利用领域驱动设计的概念来寻找“上下文边界”来定义微服务的边界是一个很好的开始。我承认，我经常看到一些单体系统的解耦在粒度上“矫枉过正”，将一个过大的系统切分为了过小的服务，而这些过小的服务常常是从现有数据的视角上出发的。而这种的微服务识别方法，几乎总是会导致大量与资源的CURD直接相关的贫血服务的“寒武纪生物大爆发”。对于新的微服务架构来说，这将创建一个高度摩擦的环境，并且最终无法独立发布测试，也无法提供服务。这种方式创建了一个难以调试的分布式系统，一个跨越事务边界的分布式系统，因此很难保持一致，这一切对于运维来说，太复杂了。尽管存在一些关于微服务粒度的“启发方法”，诸如团队大小，重写服务的时间，必须包括多少行为等等，我的建议是，微服务的规模将取决于运维团队可以独立发布、监控和运营的服务数量。首先，围绕领域概念构建一个大型服务，待团队的微服务运维能力提升之后再将其分解为多个小服务。</p> <p>例如，在解耦零售系统的过程中，开发者可以从“购买”服务开始解耦。“购买”服务内封装了“购物袋”的功能，还封装了购买一个真正的购物袋的功能，即“结账”。而随着他们组建团队并发布更多服务的能力不断增强，他们可以将“购物袋”功能从“结账”中解耦出来，成为一个单独的服务.</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013663-c77772de-4ccb-4bad-869d-8acdc50e5b02.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_17%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h3 id="_1-3-8-原子性地按步迁移"><a href="#_1-3-8-原子性地按步迁移" class="header-anchor">#</a> 1.3.8 原子性地按步迁移</h3> <p>每一次的架构演进，都应该是原子性的——无论是一个小步骤还是一个大飞跃，要么完成，要么回滚。这是非常重要的，因为我们正在采取迭代和渐进的方法来改进整体架构和进行服务解耦。就完成架构目标而言，每个改变都必须让我们处于更好的位置。使用“演进架构”的适应度函数进行隐喻的话，演进的每个原子步骤之后的架构适应度函数都应该对架构的目标产生更高价值。</p> <p>单体系统解构的原子单元包括：</p> <p>解耦新服务</p> <p>将调用方重定向至新服务</p> <p>从单体系统中删除老代码</p> <p>反模式：解耦新服务给新的调用方调用，但是却不淘汰旧服务</p> <p>让我举一个例子来说明这一点。 想象一下，微服务架构的目标是提高开发人员的修改系统以提供价值的速度。团队决定将最终用户身份验证解耦为一个基于OAuth 2.0协议的单独服务。此服务旨在替代现有老架构中的用户身份验证系统，并以微服务的新体系结构来进行身份验证。 我们将这种增量改变称为“导入鉴权服务”。导入这项新服务的一种方法是：</p> <p>（1）构建鉴权服务，实现OAuth 2.0协议。</p> <p>（2）在老系统后端添加一个新的认证路径，以调用鉴权服务来认证最终用户。</p> <p>如果团队至此而止，转而去开发一些其他服务或功能的话，他们会将整体架构置于熵增状态。因为在此状态下，有两种实现用户身份验证的方式，即新的OAuth 2.0路径和旧客户端的基于密码/会话的路径。在这一点上，团队实际上远离了实现更快更改的总体目标。对于新来的老系统开发人员来说，现在需要处理两条代码路径了。这实际上增加了熟悉代码的工作量，还导致更改和测试代码的过程变得更慢了。</p> <p>相反，团队可以在我们的原子演进单元中包含以下步骤：</p> <p>（3）将旧客户端的基于密码/会话的身份验证替换为OAuth 2.0路径</p> <p>（4）从老系统中删除旧的验证路径</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013826-51d2d01b-f5a9-491d-9159-f40a875567ac.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_23%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <ol><li>鲁班电商微服务架构</li></ol> <p><strong>单体架构：</strong></p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013756-bc756930-054f-493b-9c86-aeb0741a9adc.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_33%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <p><strong>分布式架构：</strong></p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013801-b9e00c62-2cbd-422d-a4e4-83893a6bcf80.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_36%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <ol><li>认证中心服务搭建详解</li></ol> <p>Oauth2+JWT搭建认证中心(防篡改)</p> <h2 id="_3-1-jwt结构"><a href="#_3-1-jwt结构" class="header-anchor">#</a> 3.1  JWT结构</h2> <p>官方文档 ： https://jwt.io/introduction/</p> <p>JWT是由三段信息构成的，将这三段信息文本用<code>.</code>链接一起就构成了Jwt字符串。就像这样:</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013865-19a47df1-21ce-4253-a90c-43a426bee645.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_21%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <p>eyJhbGciOiJIUzUxMiJ9.eyJzY2hvb2wiOiJsdWJhbiIsIm5hbWUiOiJib2xlIiwiZXhwIjoxNTkyODA2ODA2LCJpYXQiOjE1OTI3NDY4MDZ9.565mhMJXWOuUEIYYiYxnwrk7BSiR-XMGxd5Ydnp5Ng6nYBrt0D21ChsQFS3HAjkAfBPMhWxdedq2uc5Qhys1aA</p> <p><strong>JWT的构****成</strong></p> <p>第一部分我们称它为头部（header),第二部分我们称其为载荷（payload, 类似于飞机上承载的物品)，第三部分是签证（signature).</p> <p>header</p> <p>jwt的头部承载两部分信息：</p> <ul><li>声明类型，这里是jwt</li> <li>声明加密的算法 通常直接使用 HMAC SHA256</li></ul> <p>完整的头部就像下面这样的JSON：</p> <p>{</p> <p>'typ': 'JWT',</p> <p>'alg': 'HS256'</p> <p>}</p> <p>然后将头部进行base64加密（该加密是可以对称解密的),构成了第一部分.</p> <p>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9</p> <p><strong>playload</strong></p> <p>载荷就是存放有效信息的地方。这个名字像是特指飞机上承载的货品，这些有效信息包含三个部分</p> <ul><li>标准中注册的声明</li> <li>公共的声明</li> <li>私有的声明</li></ul> <p><strong>标准中注册的声明</strong> (建议但不强制使用) ：</p> <ul><li><strong>iss</strong>: jwt签发者</li> <li><strong>sub</strong>: jwt所面向的用户</li> <li><strong>aud</strong>: 接收jwt的一方</li> <li><strong>exp</strong>: jwt的过期时间，这个过期时间必须要大于签发时间</li> <li><strong>nbf</strong>: 定义在什么时间之前，该jwt都是不可用的.</li> <li><strong>iat</strong>: jwt的签发时间</li> <li><strong>jti</strong>: jwt的唯一身份标识，主要用来作为一次性token,从而回避重放攻击。</li></ul> <p><strong>公共的声明</strong> ：</p> <p>公共的声明可以添加任何的信息，一般添加用户的相关信息或其他业务需要的必要信息.但不建议添加敏感信息，因为该部分在客户端可解密.</p> <p><strong>私有的声明</strong> ：</p> <p>私有声明是提供者和消费者所共同定义的声明，一般不建议存放敏感信息，因为base64是对称解密的，意味着该部分信息可以归类为明文信息。</p> <p>定义一个payload:</p> <p>{</p> <p>&quot;name&quot;: &quot;bole&quot;,</p> <p>&quot;school&quot;: &quot;luban&quot;</p> <p>}</p> <p>然后将其进行base64加密，得到Jwt的第二部分。</p> <p>eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9</p> <p><strong>signature</strong></p> <p>jwt的第三部分是一个签证信息，这个签证信息由三部分组成：</p> <ul><li>header (base64后的)</li> <li>payload (base64后的)</li> <li>secret</li></ul> <p>这个部分需要base64加密后的header和base64加密后的payload使用<code>.</code>连接组成的字符串，然后通过header中声明的加密方式进行加盐<code>secret</code>组合加密，然后就构成了jwt的第三部分。</p> <p>HMACSHA256(base64UrlEncode(header) + &quot;.&quot; + base64UrlEncode(payload),</p> <p>secret)</p> <p>将这三部分用<code>.</code>连接成一个完整的字符串,构成了最终的jwt:</p> <p>eyJhbGciOiJIUzUxMiJ9.eyJzY2hvb2wiOiJsdWJhbiIsIm5hbWUiOiJib2xlIiwiZXhwIjoxNTkyODA2ODA2LCJpYXQiOjE1OTI3NDY4MDZ9.565mhMJXWOuUEIYYiYxnwrk7BSiR-XMGxd5Ydnp5Ng6nYBrt0D21ChsQFS3HAjkAfBPMhWxdedq2uc5Qhys1aA</p> <p><strong>注意：secret是保存在服务器端的，jwt的签发生成也是在服务器端的，secret就是用来进行jwt的签发和jwt的验证，所以，它就是你服务端的私钥，在任何场景都不应该流露出去。一旦客户端得知这个secret, 那就意味着客户端是可以自我签发jwt了。</strong></p> <p>。</p> <h2 id="_3-1-jwt证书生成"><a href="#_3-1-jwt证书生成" class="header-anchor">#</a> 3.1 jwt证书生成</h2> <p>JWT令牌生成采用非对称加密算法</p> <p>1、生成密钥证书 下边命令生成密钥证书，采用RSA 算法每个证书包含公钥和私钥</p> <p>Keytool 是一个java提供的证书管理工具 。</p> <p>-alias：密钥的别名</p> <p>-keyalg：使用的hash算法</p> <p>-keypass：密钥的访问密码</p> <p>-keystore：密钥库文件名，xc.keystore保存了生成的证书</p> <p>-storepass：密钥库的访问密码</p> <p>查询证书信息： keytool -list -keystore xc.keystore</p> <p>keytool -genkeypair -alias jwt -keyalg RSA -keypass 12345678 -keystore c:/jwt/jwt.jks -storepass 123456</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013820-8ff4afc1-ea2c-4d00-8517-c0e08fdc184a.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_40%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h2 id="_3-2-创建基于jwt的认证中心"><a href="#_3-2-创建基于jwt的认证中心" class="header-anchor">#</a> 3.2 创建基于JWT的认证中心</h2> <h3 id="_3-2-1-创建认证中心"><a href="#_3-2-1-创建认证中心" class="header-anchor">#</a> 3.2.1 创建认证中心</h3> <p>工程名： luban-gateway-auth-server-jwt</p> <p>配置中心类AuthServerJwtDbConfig</p> <p>/**</p> <p>* 方法实现说明: 使用jwt存储token</p> <p>*/</p> <p>@Bean</p> <p>public TokenStore tokenStore(){</p> <p>return new JwtTokenStore(jwtAccessTokenConverter());</p> <p>}</p> <p>jwt转换器</p> <p>@Bean</p> <p>public JwtAccessTokenConverter jwtAccessTokenConverter() {</p> <p>JwtAccessTokenConverter converter = new JwtAccessTokenConverter();</p> <p>//jwt的密钥</p> <p>converter.setKeyPair(keyPair());</p> <p>return converter;</p> <p>}</p> <p>加载key文件</p> <p>@Bean</p> <p>public KeyPair keyPair() {</p> <p>//store path+storepass</p> <p>KeyStoreKeyFactory keyStoreKeyFactory = new KeyStoreKeyFactory(new ClassPathResource(&quot;jwt.jks&quot;), &quot;123456&quot;.toCharArray());</p> <p>//key+keypass</p> <p>return keyStoreKeyFactory.getKeyPair(&quot;jwt&quot;, &quot;12345678&quot;.toCharArray());</p> <p>//return keyStoreKeyFactory.getKeyPair(&quot;jwt&quot;);</p> <p>}</p> <p>@Bean</p> <p>public LubanTokenEnhancer tulingTokenEnhancer() {</p> <p>return new LubanTokenEnhancer();</p> <p>}</p> <p>/**</p> <p>* 方法实现说明:用于查找我们第三方客户端的组件 主要用于查找 数据库表 oauth_client_details</p> <p>*/</p> <p>@Bean</p> <p>public ClientDetailsService clientDetails() {</p> <p>return new JdbcClientDetailsService(dataSource);</p> <p>}</p> <p>/**</p> <p>* 方法实现说明:认证服务器能够给哪些 客户端颁发token  我们需要把客户端的配置 存储到</p> <p>* 数据库中 可以基于内存存储和db存储</p> <p>*/</p> <p>@Override</p> <p>public void configure(ClientDetailsServiceConfigurer clients) throws Exception {</p> <p>clients.withClientDetails(clientDetails());</p> <p>}</p> <p>/**</p> <p>* 方法实现说明:授权服务器的配置的配置</p> <p>*/</p> <p>@Override</p> <p>public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {</p> <p>TokenEnhancerChain tokenEnhancerChain = new TokenEnhancerChain();</p> <p>tokenEnhancerChain.setTokenEnhancers(Arrays.asList(tulingTokenEnhancer(),jwtAccessTokenConverter()));</p> <p>endpoints.tokenStore(tokenStore()) //授权服务器颁发的token 怎么存储的</p> <p>​      .tokenEnhancer(tokenEnhancerChain)</p> <p>​      .userDetailsService(userDetailsService) //用户来获取token的时候需要 进行账号密码</p> <p>​      .authenticationManager(authenticationManager);</p> <p>/**</p> <p>* 方法实现说明:授权服务器安全配置</p> <p>*/</p> <p>@Override</p> <p>public void configure(AuthorizationServerSecurityConfigurer security) throws Exception {</p> <p>//第三方客户端校验token需要带入 clientId 和clientSecret来校验</p> <p>security .checkTokenAccess(&quot;isAuthenticated()&quot;)</p> <p>​       .tokenKeyAccess(&quot;isAuthenticated()&quot;);//来获取我们的tokenKey需要带入clientId,clientSecret</p> <p>security.allowFormAuthenticationForClients();</p> <p>}</p> <h3 id="-3"><a href="#-3" class="header-anchor">#</a></h3> <h3 id="_3-2-2-创建网关"><a href="#_3-2-2-创建网关" class="header-anchor">#</a> 3.2.2 创建网关</h3> <p>工程名 luban-gateway-jwt</p> <p>创建过滤器  AuthorizationFilter</p> <p>@Override</p> <p>public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain)  {</Void></p> <p>String reqPath = exchange.getRequest().getURI().getPath();</p> <p>log.info(&quot;网关认证开始URL-&gt;:{}&quot;,reqPath);</p> <p>//1:不需要认证的url</p> <p>if(shouldSkip(reqPath)) {</p> <p>​    log.info(&quot;无需认证的路径&quot;);</p> <p>​    return chain.filter(exchange);</p> <p>}</p> <p>//获取请求头</p> <p>String authHeader = exchange.getRequest().getHeaders().getFirst(&quot;Authorization&quot;);</p> <p>//请求头为空</p> <p>if(StringUtils.isEmpty(authHeader)) {</p> <p>​    log.warn(&quot;需要认证的url,请求头为空&quot;);</p> <p>//  throw new GateWayException(SystemErrorType.UNAUTHORIZED_HEADER_IS_EMPTY);</p> <p>}</p> <p>//交易我们的jwt 若jwt不对或者超时都会抛出异常</p> <p>Claims claims = validateJwtToken(authHeader);</p> <p>//向headers中放文件，记得build</p> <p>​    ServerHttpRequest request = exchange.getRequest().mutate().header(&quot;username&quot;,claims.get(&quot;user_name&quot;).toString()).build();</p> <p>//将现在的request 变成 change对象</p> <p>ServerWebExchange serverWebExchange = exchange.mutate().request(request).build();</p> <p>//从jwt中解析出权限集合进行判断</p> <p>hasPremisson(claims,reqPath);</p> <p>return chain.filter(serverWebExcha</p> <p>校验jwt token</p> <p>private Claims validateJwtToken(String authHeader) {</p> <p>String token =null ;</p> <p>try{</p> <p>​     token = StringUtils.substringAfter(authHeader, &quot;bearer &quot;);</p> <p>​    Jwt&lt;JwsHeader, Claims&gt; parseClaimsJwt = Jwts.parser().setSigningKey(publicKey).parseClaimsJws(token);</p> <p>​    Claims claims = parseClaimsJwt.getBody();</p> <p>​    log.info(&quot;claims:{}&quot;,claims);</p> <p>​    return claims;</p> <p>}catch(Exception e){</p> <p>​    log.error(&quot;校验token异常:{},异常信息:{}&quot;,token,e.getMessage());</p> <p>​    // throw new GateWayException(SystemErrorType.INVALID_TOKEN);</p> <p>​    throw e;</p> <p>}</p> <p>@Override</p> <p>public void afterPropertiesSet() throws Exception {</p> <p>shouldSkipUrl.add(&quot;/oauth/token&quot;);</p> <p>shouldSkipUrl.add(&quot;/oauth/check_token&quot;);</p> <p>shouldSkipUrl.add(&quot;/user/getCurrentUser&quot;);</p> <p>//初始化公钥</p> <p>this.publicKey = genPublicKeyByTokenKey();</p> <p>}</p> <p>/**</p> <p>* 方法实现说明:去认证服务器上获取tokenKey</p> <p>*/</p> <p>private String getTokenKey(){</p> <p>HttpHeaders headers = new HttpHeaders();</p> <p>headers.setContentType(MediaType.APPLICATION_FORM_URLENCODED);</p> <p>headers.setBasicAuth(MDA.clientId,MDA.clientSecret);</p> <p>HttpEntity&lt;MultiValueMap&lt;String, String&gt;&gt; entity = new HttpEntity&lt;&gt;(null, headers);</p> <p>try {</p> <p>​    ResponseEntity<Map> response = restTemplate.exchange(MDA.getTokenKey, HttpMethod.GET, entity, Map.class);</Map></p> <p>​    String tokenKey = response.getBody().get(&quot;value&quot;).toString();</p> <p>​    log.info(&quot;去认证服务器获取TokenKey:{}&quot;,tokenKey);</p> <p>​    return tokenKey;</p> <p>}catch (Exception e) {</p> <p>​    log.error(&quot;远程调用认证服务器获取tokenKey失败:{}&quot;,e.getMessage());</p> <p>​    //throw new GateWayException(SystemErrorType.GET_TOKEN_KEY_ERROR);</p> <p>​    throw new RuntimeException(&quot;远程调用认证服务器获取tokenKey失败&quot;);</p> <p>//生成公钥</p> <p>private PublicKey genPublicKeyByTokenKey() {</p> <p>try{</p> <p>​    String tokenKey = getTokenKey();</p> <p>​    String dealTokenKey =tokenKey.replaceAll(&quot;\-<em>BEGIN PUBLIC KEY\-</em>&quot;, &quot;&quot;).replaceAll(&quot;\-<em>END PUBLIC KEY\-</em>&quot;, &quot;&quot;).trim();</p> <p>​    java.security.Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());</p> <p>​    X509EncodedKeySpec pubKeySpec = new X509EncodedKeySpec(Base64.decodeBase64(dealTokenKey));</p> <p>​    KeyFactory keyFactory = KeyFactory.getInstance(&quot;RSA&quot;);</p> <p>​    PublicKey publicKey = keyFactory.generatePublic(pubKeySpec);</p> <p>​    log.info(&quot;生成公钥:{}&quot;,publicKey);</p> <p>​    return publicKey;</p> <p>}catch (Exception e) {</p> <p>​    log.info(&quot;生成公钥异常:{}&quot;,e.getMessage());</p> <p>​    // throw e;</p> <p>​    throw new RuntimeException(&quot;生成公钥异常&quot;);</p> <h2 id="_3-3-测试"><a href="#_3-3-测试" class="header-anchor">#</a> 3.3 测试</h2> <h3 id="_3-3-1-获取-jwt-token"><a href="#_3-3-1-获取-jwt-token" class="header-anchor">#</a> 3.3.1 获取 jwt token</h3> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013892-77c8bcd6-8fb4-4d8c-a49f-427068ba7569.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_41%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013743-1a56f73c-9ec6-4245-a731-ce502d1bf25e.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_41%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <p>access_token:</p> <p>eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOlsib3JkZXItc2VydmljZSJdLCJ1c2VyX25hbWUiOiJhZG1pbiIsInNjb3BlIjpbInJlYWQiXSwiYWRkaXRpb25hbEluZm8iOnsicGhvbmUiOm51bGwsIm5pY2tOYW1lIjoi566h55CG5ZGYIiwidXNlcklkIjoxLCJlbWFpbCI6ImFkbWluQHFxLmNvbSJ9LCJleHAiOjE1OTI4MzY2OTYsImF1dGhvcml0aWVzIjpbIi9vcmRlci9saXN0IiwiL29yZGVyL3NhdmVPcmRlciIsIi9vcmRlci9maW5kIiwiL3Byb2R1Y3Qvc2VsZWN0UHJvZHVjdEluZm9CeUlkIl0sImp0aSI6IjBmYjAzNGViLWVjODgtNGFlYS1iMjYxLWUwNTllYWUwNTI1MSIsImNsaWVudF9pZCI6ImZyb250X2FwcCJ9.rYFZRdM1l9ODf3_HezKmdvEbmpP9lWIz0HaDUPtGPtRhm9_Hwxa7CPfTIawOs56yNQCKimYyU370wa6fyxSfTLzKLcvwu5sKqiiJlSNffZw07o7gJjFp46WQK6VWVzDbTkTjs4vY0lRX69I29x5q0_NxirqsIBkq7RH2kirtf4nchWwDpDKJB3QKEjE799ViGQnp-2235WQGIXNXzTgTXcqF4dyEg3nDVh7i6-UO9f-SSlD3umL1LAK50_2MBEDjsupwK7Ha4pYo3LUdJ8yHW789v_RsNm6zx1d_h3rZg28Ayrn-8N4J544Z6J2_2XnJnqPKde4lrOo_-p6ipkHnYw</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013860-f8c6dcd7-dbe0-4b45-ba9d-ad81321ad52a.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_47%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h3 id="_3-3-2-校验jwt-token"><a href="#_3-3-2-校验jwt-token" class="header-anchor">#</a> 3.3.2 校验jwt token</h3> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013836-8389f49e-ffc2-4f7b-a4ac-d34ae6ee6880.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_53%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013720-6044eaa7-7a87-4a52-8d27-c22b54671e92.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_54%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h3 id="_3-3-3-jwt校验订单服务"><a href="#_3-3-3-jwt校验订单服务" class="header-anchor">#</a> 3.3.3 jwt校验订单服务</h3> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013804-87acee1f-f31b-48e8-a05a-4167cc1ef57c.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_42%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013799-a5b79fe3-639d-4b92-9335-bb6c03303a8e.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_42%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <ol><li>鲁班电商认证中心实战</li></ol> <h2 id="_4-1-新建luban-auth模块"><a href="#_4-1-新建luban-auth模块" class="header-anchor">#</a> 4.1 新建luban-auth模块</h2> <h3 id="_4-1-1-pom文件"><a href="#_4-1-1-pom文件" class="header-anchor">#</a> 4.1.1 POM文件</h3>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
<p>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</p> <p>​     xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;%3E</p> <p><modelVersion>4.0.0</modelVersion></p> <parent><p>​    <groupId>com.luban</groupId></p> <p>​    <artifactId>luban-mall</artifactId></p> <p>​    <version>0.0.1-SNAPSHOT</version></p></parent> <p><groupId>com.luban</groupId></p> <p><artifactId>luban-auth</artifactId></p> <p><version>0.0.1-SNAPSHOT</version></p> <p><name>luban-auth</name></p> <p><description>认证授权中心</description></p> <properties><p>​    &lt;java.version&gt;1.8&lt;/java.version&gt;</p></properties> <dependencies><p>​    <dependency></dependency></p> <p>​      <groupId>org.springframework.boot</groupId></p> <p>​      <artifactId>spring-boot-starter</artifactId></p> <p>​    </p> <p>​    <dependency></dependency></p> <p>​      <groupId>org.springframework.boot</groupId></p> <p>​      <artifactId>spring-boot-starter-web</artifactId></p> <p>​    </p> <p>​    </p> <p>​    <dependency></dependency></p> <p>​      <groupId>com.alibaba.cloud</groupId></p> <p>​      <artifactId>spring-cloud-alibaba-nacos-discovery</artifactId></p> <p>​    </p> <p>​    </p> <p>​    <dependency></dependency></p> <p>​      <groupId>org.springframework.cloud</groupId></p> <p>​      <artifactId>spring-cloud-starter-oauth2</artifactId></p> <p>​    </p> <p>​    <dependency></dependency></p> <p>​      <groupId>com.luban</groupId></p> <p>​      <artifactId>luban-mybatis</artifactId></p> <p>​    </p> <p>​    <dependency></dependency></p> <p>​      <groupId>org.springframework.boot</groupId></p> <p>​      <artifactId>spring-boot-configuration-processor</artifactId></p> <p>​      <optional>true</optional></p> <p>​    </p></dependencies> <build><p>​    <plugins></plugins></p> <p>​      <plugin></plugin></p> <p>​        <groupId>org.springframework.boot</groupId></p> <p>​        <artifactId>spring-boot-maven-plugin</artifactId></p> <p>​      </p> <p>​    </p></build> <h3 id="_4-1-2-认证中心客户端配置"><a href="#_4-1-2-认证中心客户端配置" class="header-anchor">#</a> 4.1.2 认证中心客户端配置</h3> <p>采用JDBC存储token信息</p> <p>@Override</p> <p>public void configure(ClientDetailsServiceConfigurer clients) throws Exception {</p> <p>clients.withClientDetails(clientDetails());</p> <p>}</p> <p>@Bean</p> <p>public ClientDetailsService clientDetails() {</p> <p>return new JdbcClientDetailsService(dataSource);</p> <p>}</p> <p>认证服务器端点配置</p> <p>@Override</p> <p>public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {</p> <p>//通过增强器拿到用户信息</p> <p>TokenEnhancerChain tokenEnhancerChain = new TokenEnhancerChain();</p> <p>tokenEnhancerChain.setTokenEnhancers(Arrays.asList(JwtTokenEnhancer(),jwtAccessTokenConverter()));</p> <p>endpoints.tokenStore(tokenStore()) //授权服务器颁发的token 怎么存储的</p> <p>​      .tokenEnhancer(tokenEnhancerChain)</p> <p>​      .userDetailsService(JwtUserDetailService) //用户来获取token的时候需要 进行账号密码</p> <p>​      .authenticationManager(authenticationManager);</p> <p>}</p> <p>@Bean</p> <p>public JwtAccessTokenConverter jwtAccessTokenConverter() {</p> <p>JwtAccessTokenConverter converter = new JwtAccessTokenConverter();</p> <p>//jwt的密钥</p> <p>converter.setKeyPair(keyPair());</p> <p>return converter;</p> <p>}</p> <p>@Bean</p> <p>public KeyPair keyPair() {</p> <p>KeyStoreKeyFactory keyStoreKeyFactory = new KeyStoreKeyFactory(new ClassPathResource(jwtCAProperties.getKeyPairName()), jwtCAProperties.getKeyPairStoreSecret().toCharArray());</p> <p>return keyStoreKeyFactory.getKeyPair(jwtCAProperties.getKeyPairAlias(), jwtCAProperties.getKeyPairSecret().toCharArray())</p> <p><strong>授权服务器安全配置</strong></p> <p>/**</p> <p>* 方法实现说明:授权服务器安全配置</p> <p>*/</p> <p>@Override</p> <p>public void configure(AuthorizationServerSecurityConfigurer security) throws Exception {</p> <p>//第三方客户端校验token需要带入 clientId 和clientSecret来校验</p> <p>security .checkTokenAccess(&quot;isAuthenticated()&quot;)</p> <p>​       .tokenKeyAccess(&quot;isAuthenticated()&quot;);//来获取我们的tokenKey需要带入clientId,clientSecret</p> <p>security.allowFormAuthenticationForClients();</p> <p>}</p> <p><strong>增强器重写</strong></p> <p>public OAuth2AccessToken enhance(OAuth2AccessToken accessToken, OAuth2Authentication authentication) {</p> <p>MemberDetails memberDetails = (MemberDetails) authentication.getPrincipal();</p> <p>final Map&lt;String, Object&gt; additionalInfo = new HashMap&lt;&gt;();</p> <p>final Map&lt;String, Object&gt; retMap = new HashMap&lt;&gt;();</p> <p>//暴露memberId到Jwt的令牌中,后期可以根据自己的业务需要 进行添加字段</p> <p>additionalInfo.put(&quot;memberId&quot;,memberDetails.getUmsMember().getId());</p> <p>additionalInfo.put(&quot;nickName&quot;,memberDetails.getUmsMember().getNickname());</p> <p>additionalInfo.put(&quot;integration&quot;,memberDetails.getUmsMember().getIntegration());</p> <p>retMap.put(&quot;additionalInfo&quot;,additionalInfo);</p> <p>((DefaultOAuth2AccessToken) accessToken).setAdditionalInformation(retMap);</p> <p>return accessTo</p> <h3 id="_4-1-3-web安全配置"><a href="#_4-1-3-web安全配置" class="header-anchor">#</a> 4.1.3 WEB安全配置</h3> <p>public class WebSecurityConfig extends WebSecurityConfigurerAdapter {</p> <p>@Autowired</p> <p>private MallUserDetailService JwtUserDetailService;</p> <p>/**</p> <p>* 方法实现说明:用于构建用户认证组件,需要传递userDetailsService和密码加密器</p> <p>*/</p> <p>@Override</p> <p>protected void configure(AuthenticationManagerBuilder auth) throws Exception {</p> <p>​    auth.userDetailsService(JwtUserDetailService).passwordEncoder(passwordEncoder());</p> <p>}</p> <p>/**</p> <p>* 设置前台静态资源不拦截</p> <p>* @param web</p> <p>* @throws Exception</p> <p>*/</p> <p>@Override</p> <p>public void configure(WebSecurity web) throws Exception {</p> <p>​    web.ignoring().antMatchers(&quot;/assets/<strong>&quot;, &quot;/css/</strong>&quot;, &quot;/images/**&quot;);</p> <p>}</p> <p>@Bean</p> <p>public PasswordEncoder passwordEncoder() {</p> <p>​    return new BCryptPasswordEncoder();</p> <p>}</p> <p>@Bean</p> <p>public AuthenticationManager authenticationManagerBean() throws Exception {</p> <p>​    return super.authenticationManagerBean();</p> <p>}</p> <p>public static void main(String[] args) {</p> <p>​    System.out.println(new BCryptPasswordEncoder().encode(&quot;123456&quot;))</p> <p><strong>用户登录查询服务</strong></p> <p>@Override</p> <p>public UserDetails loadUserByUsername(String userName) throws UsernameNotFoundException {</p> <p>if(StringUtils.isEmpty(userName)) {</p> <p>​    log.warn(&quot;用户登陆用户名为空:{}&quot;,userName);</p> <p>​    throw new UsernameNotFoundException(&quot;用户名不能为空&quot;);</p> <p>}</p> <p>UmsMember umsMember = getByUsername(userName);</p> <p>if(null == umsMember) {</p> <p>​    log.warn(&quot;根据用户名没有查询到对应的用户信息:{}&quot;,userName);</p> <p>}</p> <p>log.info(&quot;根据用户名:{}获取用户登陆信息:{}&quot;,userName,umsMember);</p> <p>MemberDetails memberDetails = new MemberDetails(umsMember);</p> <p>return memberDetai</p> <h2 id="_4-2-新建luban-gateway模块"><a href="#_4-2-新建luban-gateway模块" class="header-anchor">#</a> 4.2 新建luban-gateway模块</h2> <h3 id="_4-2-1-pom配置"><a href="#_4-2-1-pom配置" class="header-anchor">#</a> 4.2.1 POM配置</h3>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
<p>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</p> <p>​     xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;%3E</p> <p><modelVersion>4.0.0</modelVersion></p> <p><groupId>com.luban</groupId></p> <p><artifactId>luban-gateway</artifactId></p> <p><version>1.0-SNAPSHOT</version></p> <p><name>luban-gateway</name></p> <p><description>网关</description></p> <parent><p>​    <groupId>com.luban</groupId></p> <p>​    <artifactId>luban-mall</artifactId></p> <p>​    <version>0.0.1-SNAPSHOT</version></p></parent> <dependencies><p>​    <dependency></dependency></p> <p>​      <groupId>com.luban</groupId></p> <p>​      <artifactId>mall-common</artifactId></p> <p>​      <exclusions></exclusions></p> <p>​        <exclusion></exclusion></p> <p>​          <groupId>com.alibaba</groupId></p> <p>​          <artifactId>druid-spring-boot-starter</artifactId></p> <p>​        </p> <p>​        <exclusion></exclusion></p> <p>​          <groupId>com.github.pagehelper</groupId></p> <p>​          <artifactId>pagehelper-spring-boot-starter</artifactId></p> <p>​        </p> <p>​      </p> <p>​    </p> <p>​    <dependency></dependency></p> <p>​      <groupId>org.springframework.cloud</groupId></p> <p>​      <artifactId>spring-cloud-starter-gateway</artifactId></p> <p>​    </p> <p>​    </p> <p>​    <dependency></dependency></p> <p>​      <groupId>com.alibaba.cloud</groupId></p> <p>​      <artifactId>spring-cloud-alibaba-nacos-discovery</artifactId></p> <p>​    </p> <p>​    </p> <p>​    <dependency></dependency></p> <p>​      <groupId>io.jsonwebtoken</groupId></p> <p>​      <artifactId>jjwt-api</artifactId></p> <p>​      <version>0.10.5</version></p> <p>​    </p> <p>​    <dependency></dependency></p> <p>​      <groupId>io.jsonwebtoken</groupId></p> <p>​      <artifactId>jjwt-impl</artifactId></p> <p>​      <version>0.10.5</version></p> <p>​      <scope>runtime</scope></p> <p>​    </p> <p>​    <dependency></dependency></p> <p>​      <groupId>io.jsonwebtoken</groupId></p> <p>​      <artifactId>jjwt-jackson</artifactId></p> <p>​      <version>0.10.5</version></p> <p>​      <scope>runtime</scope></p> <p>​    </p> <p>​    <dependency></dependency></p> <p>​      <groupId>org.springframework.boot</groupId></p> <p>​      <artifactId>spring-boot-starter-actuator</artifactId></p> <p>​    </p> <p>​    </p> <p>​    <dependency></dependency></p> <p>​      <groupId>com.alibaba.cloud</groupId></p> <p>​      <artifactId>spring-cloud-starter-alibaba-sentinel</artifactId></p> <p>​    </p> <p>​    <dependency></dependency></p> <p>​      <groupId>com.alibaba.csp</groupId></p> <p>​      <artifactId>sentinel-datasource-nacos</artifactId></p> <p>​    </p> <p>​    <dependency></dependency></p> <p>​      <groupId>com.alibaba.cloud</groupId></p> <p>​      <artifactId>spring-cloud-alibaba-sentinel-gateway</artifactId></p> <p>​    </p> <p>​    <dependency></dependency></p> <p>​      <groupId>javax.servlet</groupId></p> <p>​      <artifactId>javax.servlet-api</artifactId></p> <p>​      <version>4.0.1</version></p> <p>​      <scope>compile</scope></p> <p>​    </p></dependencies> <p>&lt;</p> <h3 id="_4-2-2-新建过滤器"><a href="#_4-2-2-新建过滤器" class="header-anchor">#</a> 4.2.2  新建过滤器</h3> <ol><li>校验是否需要拦截</li></ol> <p>​     如果不需要直接跳过拦截</p> <ol><li>如果需要拦截：</li></ol> <p>（1）拿到请求头</p> <p>（2）判断Authorization的请求头是否为空</p> <p>（3）校验我们的jwt 若jwt不对或者超时都会抛出异常</p> <p>（4）第四步 把从jwt中解析出来的 用户登陆信息存储到请求头中</p> <p>@Override</p> <p>public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {</Void></p> <p>String currentUrl = exchange.getRequest().getURI().getPath();</p> <p>//1:不需要认证的url</p> <p>if(shouldSkip(currentUrl)) {</p> <p>​    //log.info(&quot;跳过认证的URL:{}&quot;,currentUrl);</p> <p>​    return chain.filter(exchange);</p> <p>}</p> <p>//log.info(&quot;需要认证的URL:{}&quot;,currentUrl);</p> <p>//第一步:解析出我们Authorization的请求头  value为: “bearer XXXXXXXXXXXXXX”</p> <p>String authHeader = exchange.getRequest().getHeaders().getFirst(&quot;Authorization&quot;);</p> <p>//第二步:判断Authorization的请求头是否为空</p> <p>if(StringUtils.isEmpty(authHeader)) {</p> <p>​    log.warn(&quot;需要认证的url,请求头为空&quot;);</p> <p>​    throw new GateWayException(ResultCode.AUTHORIZATION_HEADER_IS_EMPTY);</p> <p>}</p> <p>//第三步 校验我们的jwt 若jwt不对或者超时都会抛出异常</p> <p>Claims claims = JwtUtils.validateJwtToken(authHeader,publicKey);</p> <p>//第四步 把从jwt中解析出来的 用户登陆信息存储到请求头中</p> <p>ServerWebExchange webExchange = wrapHeader(exchange,claims);</p> <p>return chain.filter(webExcha</p> <p><strong>从请求中拿到用户信息</strong></p> <p>private ServerWebExchange wrapHeader(ServerWebExchange serverWebExchange,Claims claims) {</p> <p>String loginUserInfo = JSON.toJSONString(claims);</p> <p>//log.info(&quot;jwt的用户信息:{}&quot;,loginUserInfo);</p> <p>String memberId = claims.get(&quot;additionalInfo&quot;,Map.class).get(&quot;memberId&quot;).toString();</p> <p>String nickName = claims.get(&quot;additionalInfo&quot;,Map.class).get(&quot;nickName&quot;).toString();</p> <p>//向headers中放文件，记得build</p> <p>ServerHttpRequest request = serverWebExchange.getRequest().mutate()</p> <p>​      .header(&quot;username&quot;,claims.get(&quot;user_name&quot;,String.class))</p> <p>​      .header(&quot;memberId&quot;,memberId)</p> <p>​      .header(&quot;nickName&quot;,nickName)</p> <p>​      .build();</p> <p>//将现在的request 变成 change对象</p> <p>return serverWebExchange.mutate().request(request).build</p> <h3 id="_4-2-3-测试"><a href="#_4-2-3-测试" class="header-anchor">#</a> 4.2.3 测试</h3> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013750-65887095-755c-4bc6-bcb9-5d402cb32d1c.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_41%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013891-1a1c80f1-eab2-4955-b5cf-a51904a5a145.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_40%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h2 id="_4-3-新建luban-member会员模块"><a href="#_4-3-新建luban-member会员模块" class="header-anchor">#</a> 4.3 新建luban-member会员模块</h2> <h3 id="_4-3-1-登录获取token"><a href="#_4-3-1-登录获取token" class="header-anchor">#</a> 4.3.1 登录获取token</h3> <p>@ApiOperation(&quot;会员登录&quot;)</p> <p>@RequestMapping(value = &quot;/login&quot;, method = RequestMethod.POST)</p> <p>@ResponseBody</p> <p>public CommonResult login(@RequestParam String username,</p> <p>​             @RequestParam String password) {</p> <p>TokenInfo tokenInfo = memberService.login(username, password);</p> <p>if (tokenInfo == null) {</p> <p>​    return CommonResult.validateFailed(&quot;用户名或密码错误&quot;);</p> <p>}</p> <p>Map&lt;String, String&gt; tokenMap = new HashMap&lt;&gt;();</p> <p>tokenMap.put(&quot;token&quot;, tokenInfo.getAccess_token());</p> <p>tokenMap.put(&quot;tokenHead&quot;, tokenHead);</p> <p>tokenMap.put(&quot;refreshToken&quot;,tokenInfo.getRefresh_token());</p> <p>return CommonResult.success(tokenMap);</p> <p>}</p> <p><strong>调用认证服务器</strong></p> <p>public TokenInfo login(String username, String password) {</p> <p>ResponseEntity<TokenInfo> response;</TokenInfo></p> <p>try{</p> <p>​    //远程调用认证服务器 进行用户登陆</p> <p>​    response = restTemplate.exchange(MDA.OAUTH_LOGIN_URL, HttpMethod.POST, wrapOauthTokenRequest(username,password), TokenInfo.class);</p> <p>​    TokenInfo tokenInfo = response.getBody();</p> <p>​    LOGGER.info(&quot;根据用户名:{}登陆成功:TokenInfo:{}&quot;,username,tokenInfo);</p> <p>​    return tokenInfo;</p> <p>}catch (Exception e) {</p> <p>​    LOGGER.error(&quot;根据用户名:{}登陆异常:{}&quot;,username,e.getMessage());</p> <p>​    return null;</p> <p><strong>封装请求报文</strong></p> <p>private HttpEntity&lt;MultiValueMap&lt;String, String&gt;&gt; wrapOauthTokenRequest(String userName, String password) {</p> <p>//封装oauth2 请求头 clientId clientSecret</p> <p>HttpHeaders httpHeaders = wrapHttpHeaders();</p> <p>//封装请求参数</p> <p>MultiValueMap&lt;String, String&gt; reqParams = new LinkedMultiValueMap&lt;&gt;();</p> <p>reqParams.add(MDA.USER_NAME,userName);</p> <p>reqParams.add(MDA.PASS,password);</p> <p>reqParams.add(MDA.GRANT_TYPE,MDA.PASS);</p> <p>reqParams.add(MDA.SCOPE,MDA.SCOPE_AUTH);</p> <p>//封装请求参数</p> <p>HttpEntity&lt;MultiValueMap&lt;String, String&gt;&gt; entity = new HttpEntity&lt;&gt;(reqParams, httpHeaders);</p> <p>return entity</p> <h3 id="_4-3-2-获取会员信息校验token"><a href="#_4-3-2-获取会员信息校验token" class="header-anchor">#</a> 4.3.2 获取会员信息校验token</h3> <p>@ApiOperation(value = &quot;获取会员信息#杨过添加&quot;,notes = &quot;不包含会员等级信息,会员需要被拆分成微服务&quot;)</p> <p>@GetMapping(&quot;/loadUmsMember&quot;)</p> <p>public CommonResult<UmsMember> loadUserByUsername(String username){</UmsMember></p> <p>UmsMember umsMember = umsMemberService.getByUsername(username);</p> <p>if(umsMember == null){</p> <p>​    return CommonResult.failed(&quot;会员不存在或者已经被禁用&quot;);</p> <p>}</p> <p>return CommonResult.success(umsMember);</p> <p>}</p> <p>校验token</p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013919-a9f90d95-3ae2-405f-bae2-0ec2cde7a9d4.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_53%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p> <h3 id="-4"><a href="#-4" class="header-anchor">#</a> <img src="https://cdn.nlark.com/yuque/0/2020/png/1300531/1594620013838-2c624d53-2d97-45dc-9292-d5f9e5629717.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_36%2Ctext_6bKB54-t5a2m6Zmi5Ye65ZOB%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></h3></div></section> <footer class="page-edit"><!----> <!----></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:0;" data-v-ac050c62></ul></main></div> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="right:68px;bottom:290px;display:none;" data-v-5775ee02>
      欢迎来到我的博客
    </div> <div class="operation" style="right:90px;bottom:40px;display:;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:;" data-v-5775ee02></i></div> <canvas id="banniang" width="250" height="320" class="live2d" style="right:90px;bottom:-20px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    看板娘
  </div></div><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="https://assets.smallsunnyfox.com/music/2.mp3" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:200px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="https://assets.smallsunnyfox.com/music/2.jpg" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(https://assets.smallsunnyfox.com/music/2.jpg);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>강남역 4번 출구</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>Plastic / Fallin` Dild</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div><canvas id="vuepress-canvas-cursor"></canvas><!----><div class="RibbonAnimation"></div></div></div>
    <script src="/assets/js/app.d06236b9.js" defer></script><script src="/assets/js/3.fb47a76d.js" defer></script><script src="/assets/js/1.fc79f8d4.js" defer></script><script src="/assets/js/298.b9aede0d.js" defer></script>
  </body>
</html>
